<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TechVault Pro | Premium Tech Marketplace London</title>
    <meta name="description" content="London's premier destination for premium laptops and smartphones. Track orders in real-time, compare specs, read reviews. Led by Adegboye Desmond & Olusola.">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
    
    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- Flutterwave -->
    <script src="https://checkout.flutterwave.com/v3.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #0f172a;
            --secondary: #1e293b;
            --accent: #3b82f6;
            --accent-hover: #2563eb;
            --gold: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --light: #f8fafc;
            --gray: #64748b;
            --border: #e2e8f0;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            color: var(--primary);
            background: #fafafa;
            overflow-x: hidden;
        }

        /* Header Styles */
        .header {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid var(--border);
            transition: var(--transition);
        }

        .header.scrolled {
            box-shadow: var(--shadow-lg);
        }

        .top-bar {
            background: var(--primary);
            color: white;
            padding: 0.5rem 2rem;
            font-size: 0.875rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .top-bar-left {
            display: flex;
            gap: 2rem;
        }

        .top-bar a {
            color: white;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: opacity 0.3s;
        }

        .top-bar a:hover {
            opacity: 0.8;
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-family: 'Playfair Display', serif;
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--primary);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .logo-icon {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--accent), var(--primary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 800;
            font-size: 1.25rem;
        }

        .nav-center {
            flex: 1;
            max-width: 600px;
            margin: 0 3rem;
        }

        .search-box {
            position: relative;
            width: 100%;
        }

        .search-input {
            width: 100%;
            padding: 0.875rem 1rem 0.875rem 3rem;
            border: 2px solid var(--border);
            border-radius: 50px;
            font-size: 0.95rem;
            transition: var(--transition);
            background: var(--light);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent);
            background: white;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }

        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border-radius: 12px;
            box-shadow: var(--shadow-xl);
            margin-top: 0.5rem;
            max-height: 400px;
            overflow-y: auto;
            display: none;
            z-index: 100;
        }

        .search-results.active {
            display: block;
        }

        .search-item {
            padding: 1rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            cursor: pointer;
            transition: var(--transition);
            border-bottom: 1px solid var(--border);
        }

        .search-item:hover {
            background: var(--light);
        }

        .search-item img {
            width: 50px;
            height: 50px;
            object-fit: cover;
            border-radius: 8px;
        }

        .nav-links {
            display: flex;
            gap: 2.5rem;
            list-style: none;
            align-items: center;
        }

        .nav-links a {
            text-decoration: none;
            color: var(--primary);
            font-weight: 500;
            font-size: 0.95rem;
            transition: var(--transition);
            position: relative;
        }

        .nav-links a:hover {
            color: var(--accent);
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--accent);
            transition: var(--transition);
        }

        .nav-links a:hover::after {
            width: 100%;
        }

        .nav-actions {
            display: flex;
            gap: 1.25rem;
            align-items: center;
        }

        /* Currency Converter Styles */
        .currency-converter {
            position: relative;
            margin-right: 0.5rem;
        }

        .currency-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--light);
            border: 2px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.875rem;
            transition: var(--transition);
            color: var(--primary);
        }

        .currency-btn:hover {
            border-color: var(--accent);
            background: white;
        }

        .currency-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 0.5rem;
            background: white;
            border-radius: 12px;
            box-shadow: var(--shadow-xl);
            min-width: 200px;
            display: none;
            overflow: hidden;
            z-index: 1001;
            border: 1px solid var(--border);
        }

        .currency-dropdown.active {
            display: block;
            animation: slideUp 0.2s ease;
        }

        .currency-option {
            padding: 1rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: var(--transition);
            border-bottom: 1px solid var(--border);
        }

        .currency-option:last-child {
            border-bottom: none;
        }

        .currency-option:hover {
            background: var(--light);
        }

        .currency-option.active {
            background: var(--accent);
            color: white;
        }

        .currency-flag {
            font-size: 1.25rem;
        }

        .icon-btn {
            position: relative;
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.5rem;
            color: var(--primary);
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon-btn:hover {
            color: var(--accent);
            transform: translateY(-2px);
        }

        .badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--gold);
            color: white;
            font-size: 0.7rem;
            font-weight: 700;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            font-size: 0.95rem;
        }

        .btn-primary {
            background: var(--accent);
            color: white;
        }

        .btn-primary:hover {
            background: var(--accent-hover);
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(59, 130, 246, 0.3);
        }

        .btn-gold {
            background: var(--gold);
            color: white;
        }

        .btn-gold:hover {
            background: #d97706;
            transform: translateY(-2px);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
        }

        /* Hero Section */
        .hero {
            margin-top: 140px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 50%, #0f172a 100%);
            color: white;
            padding: 5rem 2rem;
            position: relative;
            overflow: hidden;
            min-height: 600px;
            display: flex;
            align-items: center;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.03'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }

        .hero-container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4rem;
            align-items: center;
            position: relative;
            z-index: 1;
            width: 100%;
        }

        .hero-content h1 {
            font-family: 'Playfair Display', serif;
            font-size: 4rem;
            line-height: 1.1;
            margin-bottom: 1.5rem;
            font-weight: 700;
        }

        .hero-content p {
            font-size: 1.25rem;
            opacity: 0.9;
            margin-bottom: 2rem;
            max-width: 500px;
            line-height: 1.8;
        }

        .hero-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .hero-stats {
            display: flex;
            gap: 3rem;
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .stat {
            text-align: left;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--gold);
            display: block;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .hero-image {
            position: relative;
            display: flex;
            justify-content: center;
        }

        .hero-image img {
            width: 100%;
            max-width: 600px;
            border-radius: 20px;
            box-shadow: 0 50px 100px rgba(0,0,0,0.5);
            transform: perspective(1000px) rotateY(-15deg) rotateX(5deg);
            transition: var(--transition);
        }

        .hero-image:hover img {
            transform: perspective(1000px) rotateY(-5deg) rotateX(0deg);
        }

        .floating-badge {
            position: absolute;
            background: white;
            color: var(--primary);
            padding: 1rem 1.5rem;
            border-radius: 12px;
            box-shadow: var(--shadow-xl);
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            animation: float 3s ease-in-out infinite;
        }

        .floating-badge.left {
            left: -20px;
            bottom: 100px;
            animation-delay: 0s;
        }

        .floating-badge.right {
            right: -20px;
            top: 50px;
            animation-delay: 1.5s;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* Checkout Modal */
        .checkout-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            overflow-y: auto;
            padding: 2rem;
        }

        .checkout-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .checkout-container {
            background: white;
            max-width: 600px;
            width: 100%;
            border-radius: 24px;
            overflow: hidden;
            animation: slideUp 0.3s ease;
            max-height: 90vh;
            overflow-y: auto;
        }

        .checkout-header {
            padding: 2rem;
            background: var(--primary);
            color: white;
            position: relative;
        }

        .checkout-body {
            padding: 2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--primary);
        }

        .form-input {
            width: 100%;
            padding: 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent);
        }

        .order-summary-checkout {
            background: var(--light);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 2rem;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.75rem;
            color: var(--gray);
        }

        .summary-item.total {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary);
            border-top: 2px solid var(--border);
            padding-top: 1rem;
            margin-top: 1rem;
        }

        /* Features Bar */
        .features-bar {
            background: white;
            padding: 2rem;
            border-bottom: 1px solid var(--border);
            position: relative;
            z-index: 10;
        }

        .features-container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 2rem;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            border-radius: 12px;
            transition: var(--transition);
        }

        .feature-item:hover {
            background: var(--light);
            transform: translateY(-2px);
        }

        .feature-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--accent), var(--primary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
        }

        .feature-text h4 {
            font-size: 1rem;
            margin-bottom: 0.25rem;
        }

        .feature-text p {
            font-size: 0.875rem;
            color: var(--gray);
        }

        /* Categories Section */
        .section {
            padding: 5rem 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .section-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .section-label {
            color: var(--accent);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-size: 0.875rem;
            margin-bottom: 1rem;
            display: block;
        }

        .section-title {
            font-family: 'Playfair Display', serif;
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--primary);
        }

        .section-subtitle {
            color: var(--gray);
            font-size: 1.125rem;
            max-width: 600px;
            margin: 0 auto;
        }

        .categories-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 2rem;
        }

        .category-card {
            position: relative;
            border-radius: 24px;
            overflow: hidden;
            height: 400px;
            cursor: pointer;
            transition: var(--transition);
        }

        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-xl);
        }

        .category-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .category-card:hover img {
            transform: scale(1.05);
        }

        .category-overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.8) 0%, transparent 60%);
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            padding: 2.5rem;
            color: white;
        }

        .category-tag {
            background: var(--gold);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-size: 0.875rem;
            font-weight: 700;
            display: inline-block;
            margin-bottom: 1rem;
            width: fit-content;
        }

        .category-title {
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .category-desc {
            opacity: 0.9;
            margin-bottom: 1.5rem;
        }

        /* Brands Marquee */
        .brands-section {
            background: var(--light);
            padding: 3rem 0;
            overflow: hidden;
        }

        .brands-track {
            display: flex;
            gap: 4rem;
            animation: scroll 30s linear infinite;
            width: max-content;
        }

        .brands-track:hover {
            animation-play-state: paused;
        }

        @keyframes scroll {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }

        .brand-item {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--gray);
            opacity: 0.5;
            transition: var(--transition);
            white-space: nowrap;
        }

        .brand-item:hover {
            opacity: 1;
            color: var(--primary);
        }

        /* Products Page */
        .products-page {
            display: none;
            padding-top: 140px;
            min-height: 100vh;
        }

        .products-page.active {
            display: block;
        }

        .products-layout {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 2rem;
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .sidebar {
            background: white;
            border-radius: 16px;
            padding: 1.5rem;
            height: fit-content;
            position: sticky;
            top: 160px;
            box-shadow: var(--shadow);
        }

        .filter-section {
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--border);
        }

        .filter-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .filter-title {
            font-weight: 700;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .filter-options {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .filter-option {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 8px;
            transition: var(--transition);
        }

        .filter-option:hover {
            background: var(--light);
        }

        .filter-option input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--accent);
        }

        .price-range {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .price-input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 0.875rem;
        }

        .products-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .results-count {
            color: var(--gray);
        }

        .sort-dropdown {
            padding: 0.5rem 1rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: white;
            cursor: pointer;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 2rem;
        }

        .product-card {
            background: white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            transition: var(--transition);
            border: 1px solid var(--border);
            position: relative;
            group: hover;
        }

        .product-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-xl);
            border-color: var(--accent);
        }

        .product-wishlist {
            position: absolute;
            top: 1rem;
            right: 1rem;
            width: 40px;
            height: 40px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            transform: translateY(-10px);
            transition: var(--transition);
            box-shadow: var(--shadow);
            z-index: 10;
            border: none;
            font-size: 1.25rem;
        }

        .product-card:hover .product-wishlist {
            opacity: 1;
            transform: translateY(0);
        }

        .product-wishlist.active {
            opacity: 1;
            transform: translateY(0);
            background: var(--danger);
            color: white;
        }

        .product-badge {
            position: absolute;
            top: 1rem;
            left: 1rem;
            background: var(--gold);
            color: white;
            padding: 0.35rem 0.875rem;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            z-index: 2;
        }

        .product-badge.new {
            background: var(--success);
        }

        .product-badge.sale {
            background: var(--danger);
        }

        .product-image-container {
            position: relative;
            overflow: hidden;
            height: 220px;
        }

        .product-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .product-card:hover .product-image {
            transform: scale(1.05);
        }

        .product-quick-view {
            position: absolute;
            bottom: -50px;
            left: 0;
            right: 0;
            background: var(--accent);
            color: white;
            text-align: center;
            padding: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .product-card:hover .product-quick-view {
            bottom: 0;
        }

        .product-info {
            padding: 1.5rem;
        }

        .product-brand {
            font-size: 0.875rem;
            color: var(--accent);
            font-weight: 600;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .product-name {
            font-size: 1.125rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .product-rating {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
        }

        .stars {
            color: var(--gold);
            font-size: 0.875rem;
        }

        .rating-count {
            font-size: 0.875rem;
            color: var(--gray);
        }

        .product-specs {
            font-size: 0.875rem;
            color: var(--gray);
            margin-bottom: 1rem;
            line-height: 1.5;
        }

        .product-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 1rem;
            border-top: 1px solid var(--border);
        }

        .product-price {
            display: flex;
            flex-direction: column;
        }

        .current-price {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--primary);
        }

        .original-price {
            font-size: 0.875rem;
            color: var(--gray);
            text-decoration: line-through;
        }

        .add-to-cart-btn {
            width: 44px;
            height: 44px;
            border-radius: 12px;
            background: var(--light);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            color: var(--primary);
        }

        .add-to-cart-btn:hover {
            background: var(--accent);
            color: white;
            transform: scale(1.1);
        }

        /* Product Detail Modal */
        .product-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            overflow-y: auto;
            padding: 2rem;
        }

        .product-modal.active {
            display: block;
        }

        .product-detail-container {
            background: white;
            max-width: 1200px;
            margin: 2rem auto;
            border-radius: 24px;
            overflow: hidden;
            animation: slideUp 0.3s ease;
            display: grid;
            grid-template-columns: 1fr 1fr;
        }

        .product-gallery {
            background: var(--light);
            padding: 3rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .product-gallery img {
            max-width: 100%;
            max-height: 500px;
            object-fit: contain;
        }

        .product-details {
            padding: 3rem;
            overflow-y: auto;
            max-height: 90vh;
        }

        .close-modal {
            position: absolute;
            top: 2rem;
            right: 2rem;
            width: 50px;
            height: 50px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.5rem;
            border: none;
            box-shadow: var(--shadow-lg);
            transition: var(--transition);
        }

        .close-modal:hover {
            transform: rotate(90deg);
            background: var(--danger);
            color: white;
        }

        .detail-header {
            margin-bottom: 2rem;
        }

        .detail-title {
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .detail-meta {
            display: flex;
            gap: 2rem;
            color: var(--gray);
            font-size: 0.875rem;
        }

        .detail-price {
            font-size: 3rem;
            font-weight: 800;
            color: var(--accent);
            margin: 1.5rem 0;
        }

        .detail-actions {
            display: flex;
            gap: 1rem;
            margin: 2rem 0;
        }

        .quantity-selector {
            display: flex;
            align-items: center;
            border: 2px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
        }

        .qty-btn {
            width: 50px;
            height: 50px;
            border: none;
            background: white;
            cursor: pointer;
            font-size: 1.25rem;
            transition: var(--transition);
        }

        .qty-btn:hover {
            background: var(--light);
        }

        .qty-value {
            width: 60px;
            text-align: center;
            font-weight: 700;
            font-size: 1.125rem;
        }

        .specs-table {
            width: 100%;
            border-collapse: collapse;
            margin: 2rem 0;
        }

        .specs-table tr {
            border-bottom: 1px solid var(--border);
        }

        .specs-table td {
            padding: 1rem;
        }

        .specs-table td:first-child {
            color: var(--gray);
            width: 40%;
        }

        .specs-table td:last-child {
            font-weight: 600;
        }

        /* Cart Sidebar */
        .cart-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1500;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .cart-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .cart-sidebar {
            position: fixed;
            top: 0;
            right: -500px;
            width: 500px;
            height: 100vh;
            background: white;
            z-index: 1600;
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            box-shadow: -10px 0 50px rgba(0,0,0,0.2);
        }

        .cart-sidebar.active {
            right: 0;
        }

        .cart-header {
            padding: 2rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--primary);
            color: white;
        }

        .cart-items {
            flex: 1;
            overflow-y: auto;
            padding: 1.5rem;
        }

        .cart-item {
            display: flex;
            gap: 1rem;
            padding: 1.5rem 0;
            border-bottom: 1px solid var(--border);
        }

        .cart-item-image {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 12px;
            background: var(--light);
        }

        .cart-item-details {
            flex: 1;
        }

        .cart-item-title {
            font-weight: 700;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .cart-item-variant {
            font-size: 0.875rem;
            color: var(--gray);
            margin-bottom: 0.5rem;
        }

        .cart-item-price {
            font-weight: 700;
            color: var(--accent);
            font-size: 1.125rem;
        }

        .cart-item-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-top: 0.75rem;
        }

        .cart-footer {
            padding: 2rem;
            border-top: 1px solid var(--border);
            background: var(--light);
        }

        .cart-summary {
            margin-bottom: 1.5rem;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.75rem;
            color: var(--gray);
        }

        .summary-row.total {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--primary);
            border-top: 2px solid var(--border);
            padding-top: 1rem;
            margin-top: 1rem;
        }

        /* Order Tracking */
        .tracking-page {
            display: none;
            padding-top: 140px;
            min-height: 100vh;
            background: var(--light);
        }

        .tracking-page.active {
            display: block;
        }

        .tracking-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 3rem 2rem;
        }

        .tracking-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .tracking-form {
            background: white;
            padding: 2rem;
            border-radius: 16px;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
            display: flex;
            gap: 1rem;
        }

        .tracking-input {
            flex: 1;
            padding: 1rem 1.5rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 1rem;
            transition: var(--transition);
        }

        .tracking-input:focus {
            outline: none;
            border-color: var(--accent);
        }

        .tracking-result {
            background: white;
            border-radius: 16px;
            box-shadow: var(--shadow);
            overflow: hidden;
            display: none;
        }

        .tracking-result.active {
            display: block;
        }

        .tracking-map {
            height: 300px;
            background: linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .map-marker {
            width: 60px;
            height: 60px;
            background: var(--accent);
            border-radius: 50% 50% 50% 0;
            transform: rotate(-45deg);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.4);
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: rotate(-45deg) translateY(0); }
            50% { transform: rotate(-45deg) translateY(-10px); }
        }

        .tracking-info {
            padding: 2rem;
        }

        .tracking-status {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .status-icon {
            width: 60px;
            height: 60px;
            background: var(--success);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .status-text h3 {
            font-size: 1.5rem;
            margin-bottom: 0.25rem;
        }

        .status-text p {
            color: var(--gray);
        }

        .tracking-timeline {
            position: relative;
            padding-left: 2rem;
        }

        .timeline-line {
            position: absolute;
            left: 15px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--border);
        }

        .timeline-item {
            position: relative;
            padding-bottom: 2rem;
            padding-left: 2rem;
        }

        .timeline-item.active .timeline-dot {
            background: var(--accent);
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.2);
        }

        .timeline-dot {
            position: absolute;
            left: -2rem;
            width: 32px;
            height: 32px;
            background: var(--border);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.875rem;
            z-index: 1;
        }

        .timeline-content h4 {
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .timeline-content p {
            color: var(--gray);
            font-size: 0.875rem;
        }

        /* User Account */
        .account-page {
            display: none;
            padding-top: 140px;
            min-height: 100vh;
            background: var(--light);
        }

        .account-page.active {
            display: block;
        }

        .account-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 2rem;
        }

        .account-sidebar {
            background: white;
            border-radius: 16px;
            padding: 1.5rem;
            height: fit-content;
            box-shadow: var(--shadow);
        }

        .account-menu {
            list-style: none;
        }

        .account-menu li {
            margin-bottom: 0.5rem;
        }

        .account-menu a {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem;
            border-radius: 12px;
            color: var(--primary);
            text-decoration: none;
            transition: var(--transition);
            font-weight: 500;
        }

        .account-menu a:hover,
        .account-menu a.active {
            background: var(--accent);
            color: white;
        }

        .account-content {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            box-shadow: var(--shadow);
        }

        .orders-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .order-card {
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            transition: var(--transition);
        }

        .order-card:hover {
            border-color: var(--accent);
            box-shadow: var(--shadow);
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .order-id {
            font-weight: 700;
            font-size: 1.125rem;
        }

        .order-status {
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-size: 0.875rem;
            font-weight: 600;
        }

        .order-status.delivered {
            background: #d1fae5;
            color: var(--success);
        }

        .order-status.shipped {
            background: #dbeafe;
            color: var(--accent);
        }

        .order-status.processing {
            background: #fef3c7;
            color: var(--warning);
        }

        .order-status.paid {
            background: #d1fae5;
            color: var(--success);
        }

        .order-status.pending {
            background: #fef3c7;
            color: var(--warning);
        }

        .order-items {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .order-item-thumb {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 8px;
        }

        .order-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 1rem;
            border-top: 1px solid var(--border);
        }

        /* Comparison Tool */
        .compare-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            box-shadow: 0 -10px 40px rgba(0,0,0,0.1);
            padding: 1.5rem 2rem;
            transform: translateY(100%);
            transition: var(--transition);
            z-index: 900;
        }

        .compare-bar.active {
            transform: translateY(0);
        }

        .compare-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .compare-items {
            display: flex;
            gap: 1rem;
        }

        .compare-thumb {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 8px;
            border: 2px solid var(--accent);
        }

        /* Reviews Section */
        .reviews-section {
            margin-top: 3rem;
            padding-top: 3rem;
            border-top: 1px solid var(--border);
        }

        .review-card {
            background: var(--light);
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 1rem;
        }

        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .reviewer {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .reviewer-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent), var(--primary));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.25rem;
        }

        .reviewer-info h4 {
            font-weight: 700;
        }

        .reviewer-info p {
            font-size: 0.875rem;
            color: var(--gray);
        }

        /* Enhanced Help Chat Widget */
        .chat-widget {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 1000;
        }

        .chat-button {
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, var(--accent), var(--primary));
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.4);
            transition: var(--transition);
            border: 4px solid white;
            animation: pulse-animation 2s infinite;
        }

        @keyframes pulse-animation {
            0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); }
            70% { box-shadow: 0 0 0 20px rgba(59, 130, 246, 0); }
            100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
        }

        .chat-button:hover {
            transform: scale(1.1) rotate(10deg);
        }

        .chat-window {
            position: absolute;
            bottom: 90px;
            right: 0;
            width: 380px;
            height: 550px;
            background: white;
            border-radius: 24px;
            box-shadow: var(--shadow-xl);
            display: none;
            flex-direction: column;
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .chat-window.active {
            display: flex;
            animation: slideUp 0.3s ease;
        }

        .chat-header {
            background: linear-gradient(135deg, var(--accent), var(--primary));
            color: white;
            padding: 1.5rem;
            position: relative;
        }

        .chat-header h3 {
            margin: 0;
            font-size: 1.25rem;
        }

        .chat-header p {
            margin: 0.25rem 0 0 0;
            font-size: 0.875rem;
            opacity: 0.9;
        }

        .chat-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .chat-close:hover {
            background: rgba(255,255,255,0.3);
            transform: rotate(90deg);
        }

        .quick-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
            padding: 1rem;
            background: var(--light);
            border-bottom: 1px solid var(--border);
        }

        .quick-action-btn {
            padding: 0.75rem;
            background: white;
            border: 1px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: 500;
            transition: var(--transition);
            text-align: center;
        }

        .quick-action-btn:hover {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
            transform: translateY(-2px);
        }

        .chat-messages {
            flex: 1;
            padding: 1.5rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            background: #f8fafc;
        }

        .message {
            max-width: 85%;
            padding: 1rem;
            border-radius: 16px;
            font-size: 0.9rem;
            line-height: 1.5;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message.received {
            background: white;
            align-self: flex-start;
            border-bottom-left-radius: 4px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border);
        }

        .message.sent {
            background: var(--accent);
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 4px;
        }

        .message-time {
            font-size: 0.75rem;
            opacity: 0.6;
            margin-top: 0.25rem;
        }

        .chat-input-container {
            padding: 1rem;
            background: white;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 0.5rem;
        }

        .chat-input {
            flex: 1;
            padding: 0.875rem 1.25rem;
            border: 2px solid var(--border);
            border-radius: 50px;
            outline: none;
            font-size: 0.95rem;
            transition: var(--transition);
        }

        .chat-input:focus {
            border-color: var(--accent);
        }

        .chat-send-btn {
            width: 45px;
            height: 45px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .chat-send-btn:hover {
            background: var(--accent-hover);
            transform: scale(1.1);
        }

        .typing-indicator {
            display: flex;
            gap: 0.3rem;
            padding: 1rem;
            background: white;
            border-radius: 16px;
            border-bottom-left-radius: 4px;
            width: fit-content;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border);
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--accent);
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }

        /* Footer */
        .footer {
            background: var(--primary);
            color: white;
            padding: 4rem 2rem 2rem;
            margin-top: 4rem;
        }

        .footer-grid {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 3rem;
            margin-bottom: 3rem;
        }

        .footer-brand h3 {
            font-family: 'Playfair Display', serif;
            font-size: 1.75rem;
            margin-bottom: 1rem;
        }

        .footer-brand p {
            opacity: 0.8;
            line-height: 1.8;
            margin-bottom: 1.5rem;
        }

        .social-links {
            display: flex;
            gap: 1rem;
        }

        .social-links a {
            width: 40px;
            height: 40px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            transition: var(--transition);
        }

        .social-links a:hover {
            background: var(--accent);
            transform: translateY(-3px);
        }

        .footer-links h4 {
            font-size: 1.125rem;
            margin-bottom: 1.5rem;
            color: var(--gold);
        }

        .footer-links ul {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 0.75rem;
        }

        .footer-links a {
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            transition: var(--transition);
        }

        .footer-links a:hover {
            color: white;
            padding-left: 5px;
        }

        .footer-bottom {
            max-width: 1400px;
            margin: 0 auto;
            padding-top: 2rem;
            border-top: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .payment-methods {
            display: flex;
            gap: 1rem;
            font-size: 1.5rem;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .hero-container {
                grid-template-columns: 1fr;
                text-align: center;
            }

            .hero-content h1 {
                font-size: 3rem;
            }

            .hero-image {
                display: none;
            }

            .products-layout,
            .account-container {
                grid-template-columns: 1fr;
            }

            .sidebar {
                position: static;
            }

            .features-container {
                grid-template-columns: repeat(2, 1fr);
            }

            .categories-grid {
                grid-template-columns: 1fr;
            }

            .footer-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .product-detail-container {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .nav-center {
                display: none;
            }

            .nav-links {
                display: none;
            }

            .cart-sidebar {
                width: 100%;
                right: -100%;
            }

            .features-container {
                grid-template-columns: 1fr;
            }

            .footer-grid {
                grid-template-columns: 1fr;
            }

            .hero-content h1 {
                font-size: 2.5rem;
            }

            .chat-window {
                width: 100%;
                right: -100%;
                bottom: 0;
                border-radius: 24px 24px 0 0;
                height: 70vh;
            }

            .chat-window.active {
                right: 0;
            }

            .currency-converter {
                display: none;
            }
        }

        /* Animations */
        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .animate-in {
            animation: slideUp 0.6s ease forwards;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 100px;
            right: 30px;
            background: var(--primary);
            color: white;
            padding: 1rem 2rem;
            border-radius: 12px;
            box-shadow: var(--shadow-xl);
            transform: translateX(400px);
            opacity: 0;
            transition: var(--transition);
            z-index: 2000;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }

        .toast.success {
            background: var(--success);
        }

        /* Loading States */
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* Utility Classes */
        .hidden { display: none !important; }
        .text-center { text-align: center; }
        .mt-4 { margin-top: 1rem; }
        .mb-4 { margin-bottom: 1rem; }
        .w-full { width: 100%; }
        .flex { display: flex; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .gap-4 { gap: 1rem; }

        /* Payment Mode Badge */
        .payment-mode-indicator {
            position: fixed;
            bottom: 100px;
            left: 20px;
            background: var(--warning);
            color: var(--primary);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.75rem;
            font-weight: 700;
            z-index: 999;
            display: none;
        }

        .payment-mode-indicator.active {
            display: block;
        }
    </style>
</head>
<body>

    <!-- Payment Mode Indicator -->
    <div class="payment-mode-indicator" id="paymentModeIndicator">
         TEST MODE - Use Flutterwave test cards
    </div>

    <!-- Top Bar -->
    <div class="top-bar">
        <div class="top-bar-left">
            <a href="tel:07032386595">
                <span></span> 07032386595
            </a>
            <a href="mailto:support@techvault.ng">
                <span></span> support@techvault.ng
            </a>
        </div>
        <div>
            <span> Free delivery within London  7-day returns  24/7 support</span>
        </div>
    </div>

    <!-- Header -->
    <header class="header" id="header">
        <div class="nav-container">
            <a href="#" class="logo" onclick="showPage('home')">
                <div class="logo-icon">TV</div>
                <span>TechVault</span>
            </a>

            <div class="nav-center">
                <div class="search-box">
                    <span class="search-icon"></span>
                    <input type="text" class="search-input" placeholder="Search laptops, phones, brands..." id="searchInput" oninput="handleSearch(this.value)">
                    <div class="search-results" id="searchResults"></div>
                </div>
            </div>

            <ul class="nav-links">
                <li><a href="#" onclick="showPage('home')">Home</a></li>
                <li><a href="#" onclick="showPage('laptops')">Laptops</a></li>
                <li><a href="#" onclick="showPage('phones')">Phones</a></li>
                <li><a href="#" onclick="showPage('track')">Track Order</a></li>
            </ul>

            <div class="nav-actions">
                <!-- Currency Converter -->
                <div class="currency-converter">
                    <button class="currency-btn" onclick="toggleCurrencyDropdown()">
                        <span id="currentCurrencySymbol"></span>
                        <span id="currentCurrencyCode">NGN</span>
                        <svg width="12" height="12" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="currency-dropdown" id="currencyDropdown">
                        <div class="currency-option active" onclick="changeCurrency('NGN', '', 1)">
                            <div style="display: flex; align-items: center; gap: 0.75rem;">
                                <span class="currency-flag"></span>
                                <div>
                                    <div style="font-weight: 600;">Nigerian Naira</div>
                                    <div style="font-size: 0.75rem; opacity: 0.7;">NGN</div>
                                </div>
                            </div>
                            <span style="font-weight: 700;"></span>
                        </div>
                        <div class="currency-option" onclick="changeCurrency('USD', '$', 0.0013)">
                            <div style="display: flex; align-items: center; gap: 0.75rem;">
                                <span class="currency-flag"></span>
                                <div>
                                    <div style="font-weight: 600;">US Dollar</div>
                                    <div style="font-size: 0.75rem; opacity: 0.7;">USD</div>
                                </div>
                            </div>
                            <span style="font-weight: 700;">$</span>
                        </div>
                        <div class="currency-option" onclick="changeCurrency('GBP', '', 0.0010)">
                            <div style="display: flex; align-items: center; gap: 0.75rem;">
                                <span class="currency-flag"></span>
                                <div>
                                    <div style="font-weight: 600;">British Pound</div>
                                    <div style="font-size: 0.75rem; opacity: 0.7;">GBP</div>
                                </div>
                            </div>
                            <span style="font-weight: 700;"></span>
                        </div>
                        <div class="currency-option" onclick="changeCurrency('EUR', '', 0.0012)">
                            <div style="display: flex; align-items: center; gap: 0.75rem;">
                                <span class="currency-flag"></span>
                                <div>
                                    <div style="font-weight: 600;">Euro</div>
                                    <div style="font-size: 0.75rem; opacity: 0.7;">EUR</div>
                                </div>
                            </div>
                            <span style="font-weight: 700;"></span>
                        </div>
                    </div>
                </div>

                <button class="icon-btn" onclick="showPage('account')" title="My Account">
                    <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                </button>
                <button class="icon-btn" onclick="toggleWishlist()" title="Wishlist">
                    <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg>
                    <span class="badge" id="wishlistCount">0</span>
                </button>
                <button class="icon-btn" onclick="toggleCart()" title="Cart">
                    <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path></svg>
                    <span class="badge" id="cartCount">0</span>
                </button>
            </div>
        </div>
    </header>

    <!-- HOME PAGE -->
    <div id="homePage" class="page active">
        <!-- Hero -->
        <section class="hero">
            <div class="hero-container">
                <div class="hero-content">
                    <h1>Premium Tech, Delivered with Care</h1>
                    <p>London's most trusted destination for laptops and smartphones. Real-time order tracking, expert support, and quality guaranteed by Adegboye Desmond & Olusola.</p>
                    <div class="hero-buttons">
                        <button class="btn btn-gold" onclick="showPage('laptops')">Explore Laptops</button>
                        <button class="btn btn-outline" style="color: white; border-color: white;" onclick="showPage('phones')">Shop Phones</button>
                    </div>
                    <div class="hero-stats">
                        <div class="stat">
                            <span class="stat-number">30K+</span>
                            <span class="stat-label">Happy Customers</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number">4.9</span>
                            <span class="stat-label">Average Rating</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number">2hr</span>
                            <span class="stat-label">London Delivery</span>
                        </div>
                    </div>
                </div>
                <div class="hero-image">
                    <img src="https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=800&h=600&fit=crop" alt="Premium Laptop">
                    <div class="floating-badge left">
                        <span></span>
                        <div>
                            <div style="font-size: 0.75rem; opacity: 0.8;">Just Arrived</div>
                            <div>MacBook Pro M3</div>
                        </div>
                    </div>
                    <div class="floating-badge right">
                        <span></span>
                        <div>
                            <div style="font-size: 0.75rem; opacity: 0.8;">Live Tracking</div>
                            <div>GPS Enabled</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Features Bar -->
        <div class="features-bar">
            <div class="features-container">
                <div class="feature-item">
                    <div class="feature-icon"></div>
                    <div class="feature-text">
                        <h4>Certified Quality</h4>
<p>Every device tested</p>
                    </div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon"></div>
                    <div class="feature-text">
                        <h4>Fast Delivery</h4>
                        <p>Same-day in London</p>
                    </div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon"></div>
                    <div class="feature-text">
                        <h4>Easy Returns</h4>
                        <p>7-day money back</p>
                    </div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon"></div>
                    <div class="feature-text">
                        <h4>2 Year Warranty</h4>
                        <p>Full coverage</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Categories -->
        <section class="section">
            <div class="section-header">
                <span class="section-label">Collections</span>
                <h2 class="section-title">Browse Categories</h2>
                <p class="section-subtitle">Choose from our curated selection of premium devices</p>
            </div>
            <div class="categories-grid">
                <div class="category-card" onclick="showPage('laptops')">
                    <img src="https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=800&h=600&fit=crop" alt="Laptops">
                    <div class="category-overlay">
                        <span class="category-tag">15 Products</span>
                        <h3 class="category-title">Premium Laptops</h3>
                        <p class="category-desc">From MacBooks to gaming powerhouses, find your perfect workstation.</p>
                        <button class="btn btn-gold" style="width: fit-content;">Shop Now </button>
                    </div>
                </div>
                <div class="category-card" onclick="showPage('phones')">
                    <img src="https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?w=800&h=600&fit=crop" alt="Phones">
                    <div class="category-overlay">
                        <span class="category-tag">15 Products</span>
                        <h3 class="category-title">Smartphones</h3>
                        <p class="category-desc">Latest iPhones, Samsung Galaxy, and Android flagships.</p>
                        <button class="btn btn-gold" style="width: fit-content;">Shop Now </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Brands -->
        <div class="brands-section">
            <div class="brands-track">
                <div class="brand-item">Apple</div>
                <div class="brand-item">Samsung</div>
                <div class="brand-item">Dell</div>
                <div class="brand-item">HP</div>
                <div class="brand-item">Lenovo</div>
                <div class="brand-item">Asus</div>
                <div class="brand-item">Microsoft</div>
                <div class="brand-item">Razer</div>
                <div class="brand-item">Google</div>
                <div class="brand-item">OnePlus</div>
                <div class="brand-item">Apple</div>
                <div class="brand-item">Samsung</div>
                <div class="brand-item">Dell</div>
                <div class="brand-item">HP</div>
                <div class="brand-item">Lenovo</div>
                <div class="brand-item">Asus</div>
                <div class="brand-item">Microsoft</div>
                <div class="brand-item">Razer</div>
                <div class="brand-item">Google</div>
                <div class="brand-item">OnePlus</div>
            </div>
        </div>

        <!-- Featured Products Preview -->
        <section class="section" style="background: white;">
            <div class="section-header">
                <span class="section-label">Trending Now</span>
                <h2 class="section-title">Most Popular</h2>
                <p class="section-subtitle">What our customers love most</p>
            </div>
            <div class="products-grid" id="featuredProducts"></div>
            <div class="text-center" style="margin-top: 3rem;">
                <button class="btn btn-outline" onclick="showPage('laptops')">View All Products</button>
            </div>
        </section>

        <!-- Why Choose Us -->
        <section class="section" style="background: var(--primary); color: white;">
            <div class="section-header">
                <span class="section-label" style="color: var(--gold);">Our Promise</span>
                <h2 class="section-title" style="color: white;">Why TechVault?</h2>
            </div>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 3rem; max-width: 1200px; margin: 0 auto;">
                <div style="text-align: center; padding: 2rem;">
                    <div style="width: 80px; height: 80px; background: rgba(255,255,255,0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem; font-size: 2rem;"></div>
                    <h3 style="font-size: 1.5rem; margin-bottom: 1rem;">Family Business</h3>
                    <p style="opacity: 0.8; line-height: 1.8;">Led by Adegboye Desmond & Olusola from London. Real people, real support, real care.</p>
                </div>
                <div style="text-align: center; padding: 2rem;">
                    <div style="width: 80px; height: 80px; background: rgba(255,255,255,0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem; font-size: 2rem;"></div>
                    <h3 style="font-size: 1.5rem; margin-bottom: 1rem;">GPS Tracking</h3>
                    <p style="opacity: 0.8; line-height: 1.8;">Know exactly where your order is. Real-time GPS tracking on every delivery.</p>
                </div>
                <div style="text-align: center; padding: 2rem;">
                    <div style="width: 80px; height: 80px; background: rgba(255,255,255,0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem; font-size: 2rem;"></div>
                    <h3 style="font-size: 1.5rem; margin-bottom: 1rem;">Secure Payments</h3>
                    <p style="opacity: 0.8; line-height: 1.8;">Pay securely with Flutterwave. Cards, Bank Transfer, USSD, and Mobile Money accepted.</p>
                </div>
            </div>
        </section>
    </div>

    <!-- PRODUCTS PAGE (Laptops/Phones) -->
    <div id="productsPage" class="products-page">
        <div class="products-layout">
            <!-- Sidebar Filters -->
            <aside class="sidebar">
                <div class="filter-section">
                    <div class="filter-title">
                        <span>Categories</span>
                    </div>
                    <div class="filter-options">
                        <label class="filter-option">
                            <input type="checkbox" checked onchange="toggleCategory('all')">
                            <span>All Products</span>
                        </label>
                        <label class="filter-option">
                            <input type="checkbox" onchange="toggleCategory('laptop')">
                            <span>Laptops</span>
                        </label>
                        <label class="filter-option">
                            <input type="checkbox" onchange="toggleCategory('phone')">
                            <span>Smartphones</span>
                        </label>
                    </div>
                </div>

                <div class="filter-section">
                    <div class="filter-toggle" onclick="toggleFilterSection(this)">
                        <div class="filter-title">Price Range</div>
                    </div>
                    <div class="filter-options" style="display: block;">
                        <div class="price-range" style="margin-bottom: 1rem;">
                            <input type="number" class="price-input" placeholder="Min" id="minPrice">
                            <span>-</span>
                            <input type="number" class="price-input" placeholder="Max" id="maxPrice">
                        </div>
                        <button class="btn btn-primary btn-sm w-full" onclick="applyPriceFilter()">Apply</button>
                    </div>
                </div>

                <div class="filter-section">
                    <div class="filter-title">Brands</div>
                    <div class="filter-options" id="brandFilters"></div>
                </div>

                <div class="filter-section">
                    <div class="filter-title">Rating</div>
                    <div class="filter-options">
                        <label class="filter-option">
                            <input type="checkbox" onchange="filterByRating(4)">
                            <span>4 & above</span>
                        </label>
                        <label class="filter-option">
                            <input type="checkbox" onchange="filterByRating(3)">
                            <span>3 & above</span>
                        </label>
                    </div>
                </div>
            </aside>

            <!-- Products Grid -->
            <div>
                <div class="products-header">
                    <div>
                        <h2 id="pageTitle">All Products</h2>
                        <p class="results-count" id="resultsCount">Showing 30 products</p>
                    </div>
                    <select class="sort-dropdown" onchange="sortProducts(this.value)">
                        <option value="featured">Featured</option>
                        <option value="price-low">Price: Low to High</option>
                        <option value="price-high">Price: High to Low</option>
                        <option value="rating">Highest Rated</option>
                        <option value="newest">Newest First</option>
                    </select>
                </div>
                <div class="products-grid" id="productsGrid"></div>
            </div>
        </div>
    </div>

    <!-- TRACK ORDER PAGE -->
    <div id="trackPage" class="tracking-page">
        <div class="tracking-container">
            <div class="tracking-header">
                <span class="section-label">Order Status</span>
                <h2 class="section-title">Track Your Order</h2>
                <p class="section-subtitle">Enter your order ID to see real-time location and status</p>
            </div>

            <div class="tracking-form">
                <input type="text" class="tracking-input" placeholder="Enter Order ID (e.g., TV-1234567890)" id="trackingInput">
                <button class="btn btn-primary" onclick="trackOrder()">Track Order</button>
            </div>

            <div class="tracking-result" id="trackingResult">
                <div class="tracking-map">
                    <div class="map-marker"></div>
                    <div style="position: absolute; bottom: 20px; left: 20px; background: white; padding: 1rem; border-radius: 12px; box-shadow: var(--shadow);">
                        <div style="font-weight: 700; margin-bottom: 0.25rem;">Live Location</div>
                        <div style="font-size: 0.875rem; color: var(--gray);">En route to delivery address</div>
                    </div>
                </div>
                <div class="tracking-info">
                    <div class="tracking-status">
                        <div class="status-icon"></div>
                        <div class="status-text">
                            <h3>Out for Delivery</h3>
                            <p>Your order is on the way! Estimated arrival: Today, 2:00 PM - 4:00 PM</p>
                        </div>
                    </div>

                    <div class="tracking-timeline">
                        <div class="timeline-line"></div>
                        <div class="timeline-item active">
                            <div class="timeline-dot"></div>
                            <div class="timeline-content">
                                <h4>Order Placed</h4>
                                <p id="trackDate1">Jan 27, 2024 at 10:30 AM</p>
                            </div>
                        </div>
                        <div class="timeline-item active">
                            <div class="timeline-dot"></div>
                            <div class="timeline-content">
                                <h4>Payment Confirmed</h4>
                                <p id="trackDate2">Jan 27, 2024 at 10:35 AM</p>
                            </div>
                        </div>
                        <div class="timeline-item active">
                            <div class="timeline-dot"></div>
                            <div class="timeline-content">
                                <h4>Shipped from Warehouse</h4>
                                <p id="trackDate3">Jan 27, 2024 at 2:15 PM  London Distribution Center</p>
                            </div>
                        </div>
                        <div class="timeline-item active">
                            <div class="timeline-dot" style="background: var(--accent); animation: pulse 2s infinite;"></div>
                            <div class="timeline-content">
                                <h4>Out for Delivery</h4>
                                <p id="trackCurrent">Current location: 2.5 miles away  Driver: Michael O.</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-dot"></div>
                            <div class="timeline-content">
                                <h4>Delivered</h4>
                                <p id="trackEst">Estimated: Today, 2:00 PM - 4:00 PM</p>
                            </div>
                        </div>
                    </div>

                    <div style="margin-top: 2rem; padding: 1.5rem; background: var(--light); border-radius: 12px;">
                        <h4 style="margin-bottom: 1rem;">Need Help?</h4>
                        <p style="margin-bottom: 1rem; color: var(--gray);">Contact your delivery driver or our support team</p>
                        <div style="display: flex; gap: 1rem;">
                            <button class="btn btn-outline btn-sm" onclick="window.open('https://wa.me/2347032386595')"> WhatsApp</button>
                            <button class="btn btn-primary btn-sm" onclick="window.open('tel:07032386595')"> Call Support</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ACCOUNT PAGE -->
    <div id="accountPage" class="account-page">
        <div class="account-container">
            <aside class="account-sidebar">
                <div style="text-align: center; margin-bottom: 2rem;">
                    <div style="width: 80px; height: 80px; background: linear-gradient(135deg, var(--accent), var(--primary)); border-radius: 50%; margin: 0 auto 1rem; display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem; font-weight: 700;" id="userAvatar">JD</div>
                    <h3 style="font-weight: 700;" id="userName">John Doe</h3>
                    <p style="color: var(--gray); font-size: 0.875rem;" id="userEmail">john.doe@email.com</p>
                </div>
                <ul class="account-menu">
                    <li><a href="#" class="active" onclick="showAccountTab('orders')"> My Orders</a></li>
                    <li><a href="#" onclick="showAccountTab('wishlist')"> Wishlist</a></li>
                    <li><a href="#" onclick="showAccountTab('addresses')"> Addresses</a></li>
                    <li><a href="#" onclick="showAccountTab('payment')"> Payment Methods</a></li>
                    <li><a href="#" onclick="showAccountTab('settings')"> Settings</a></li>
                    <li><a href="#" style="color: var(--danger);" onclick="logout()"> Logout</a></li>
                </ul>
            </aside>

            <div class="account-content" id="accountContent">
                <h2 style="margin-bottom: 2rem;">My Orders</h2>
                <div id="ordersListContainer">
                    <div class="orders-list" id="ordersList">
                        <!-- Orders injected by JS -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Product Detail Modal -->
    <div class="product-modal" id="productModal">
        <button class="close-modal" onclick="closeProductModal()"></button>
        <div class="product-detail-container" id="productDetailContent">
            <!-- Content injected by JS -->
        </div>
    </div>

    <!-- Checkout Modal -->
    <div class="checkout-modal" id="checkoutModal">
        <div class="checkout-container">
            <div class="checkout-header">
                <h2 style="font-family: 'Playfair Display', serif; font-size: 1.75rem;">Complete Your Order</h2>
                <button class="icon-btn" onclick="closeCheckout()" style="color: white; position: absolute; right: 1.5rem; top: 1.5rem;">
                    <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <div class="checkout-body">
                <div id="flutterwaveConfigWarning" style="background: #fef3c7; border: 2px solid var(--warning); padding: 1rem; border-radius: 8px; margin-bottom: 1rem; display: none;">
                    <strong> Payment Not Configured</strong><br>
                    <small>Add your Flutterwave Public Key to enable payments</small>
                </div>

                <form id="checkoutForm" onsubmit="initiatePayment(event)">
                    <div class="form-group">
                        <label>Full Name *</label>
                        <input type="text" class="form-input" id="customerName" required placeholder="Adegboye Desmond">
                    </div>
                    
                    <div class="form-group">
                        <label>Email Address *</label>
                        <input type="email" class="form-input" id="customerEmail" required placeholder="desmond@example.com">
                    </div>
                    
                    <div class="form-group">
                        <label>Phone Number *</label>
                        <input type="tel" class="form-input" id="customerPhone" required placeholder="07032386595">
                    </div>
                    
                    <div class="form-group">
                        <label>Delivery Address *</label>
                        <input type="text" class="form-input" id="customerAddress" required placeholder="123 London Street, London, UK">
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div class="form-group">
                            <label>City</label>
                            <input type="text" class="form-input" id="customerCity" placeholder="London">
                        </div>
                        <div class="form-group">
                            <label>Postal Code</label>
                            <input type="text" class="form-input" id="customerPostal" placeholder="SW1A 1AA">
                        </div>
                    </div>

                    <div class="order-summary-checkout">
                        <h3 style="margin-bottom: 1rem;">Order Summary</h3>
                        <div id="checkoutItems">
                            <!-- Items injected here -->
                        </div>
                        <div class="summary-item total">
                            <span>Total</span>
                            <span id="checkoutTotal">0</span>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary w-full" style="margin-top: 1.5rem; padding: 1rem;" id="payButton">
                        Pay Now with Flutterwave
                    </button>
                    
                    <div style="margin-top: 1rem; text-align: center;">
                        <div style="font-size: 0.875rem; color: var(--gray); margin-bottom: 0.5rem;">
                             Secured by Flutterwave | Cards  Bank Transfer  USSD  Mobile Money
                        </div>
                        <div style="display: flex; justify-content: center; gap: 0.5rem; margin-top: 0.5rem;">
                            <span style="font-size: 1.5rem;"></span>
                            <span style="font-size: 1.5rem;"></span>
                            <span style="font-size: 1.5rem;"></span>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Cart Sidebar -->
    <div class="cart-overlay" id="cartOverlay" onclick="toggleCart()"></div>
    <div class="cart-sidebar" id="cartSidebar">
        <div class="cart-header">
            <h3 style="font-size: 1.25rem; font-weight: 700;">Shopping Cart</h3>
            <button class="icon-btn" onclick="toggleCart()" style="color: white;">
                <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>
        </div>
        <div class="cart-items" id="cartItems">
            <!-- Cart items injected here -->
        </div>
        <div class="cart-footer" id="cartFooter" style="display: none;">
            <div class="cart-summary">
                <div class="summary-row">
                    <span>Subtotal</span>
                    <span id="cartSubtotal">0</span>
                </div>
                <div class="summary-row">
                    <span>Shipping</span>
                    <span style="color: var(--success);">Free</span>
                </div>
                <div class="summary-row total">
                    <span>Total</span>
                    <span id="cartTotal">0</span>
                </div>
            </div>
            <button class="btn btn-primary w-full" style="padding: 1rem;" onclick="openCheckout()">
                Proceed to Checkout
            </button>
            <button class="btn btn-outline w-full mt-4" onclick="toggleCart(); showPage('laptops')">
                Continue Shopping
            </button>
        </div>
    </div>

    <!-- Compare Bar -->
    <div class="compare-bar" id="compareBar">
        <div class="compare-container">
            <div style="display: flex; align-items: center; gap: 1rem;">
                <span style="font-weight: 700;">Compare Products (<span id="compareCount">0</span>/3)</span>
                <div class="compare-items" id="compareItems"></div>
            </div>
            <div style="display: flex; gap: 1rem;">
                <button class="btn btn-primary" onclick="showComparison()">Compare Now</button>
                <button class="btn btn-outline" onclick="clearCompare()">Clear All</button>
            </div>
        </div>
    </div>

    <!-- Enhanced Help Chat Widget -->
    <div class="chat-widget">
        <div class="chat-window" id="chatWindow">
            <div class="chat-header">
                <div>
                    <h3>How can we help?</h3>
                    <p>Quick guides to using TechVault</p>
                </div>
                <button class="chat-close" onclick="toggleChat()"></button>
            </div>
            
            <!-- Quick Action Buttons -->
            <div class="quick-actions">
                <button class="quick-action-btn" onclick="sendQuickMessage('how-to-order')"> How to Order</button>
                <button class="quick-action-btn" onclick="sendQuickMessage('track-order')"> Track Order</button>
                <button class="quick-action-btn" onclick="sendQuickMessage('payment')"> Payment Methods</button>
                <button class="quick-action-btn" onclick="sendQuickMessage('contact')"> Contact Us</button>
            </div>

            <div class="chat-messages" id="chatMessages">
                <div class="message received">
                    <div> Welcome to TechVault! I'm here to help you navigate our store.</div>
                    <div class="message-time">Just now</div>
                </div>
                <div class="message received">
                    <div>Choose a quick question above or type your own below!</div>
                    <div class="message-time">Just now</div>
                </div>
            </div>

            <div class="chat-input-container">
                <input type="text" class="chat-input" placeholder="Type your question..." id="chatInput" onkeypress="handleChatKey(event)">
                <button class="chat-send-btn" onclick="sendMessage()">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path></svg>
                </button>
            </div>
        </div>
        <button class="chat-button" onclick="toggleChat()" title="Get Help"></button>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast">
        <span id="toastIcon"></span>
        <span id="toastMessage">Success</span>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-grid">
            <div class="footer-brand">
                <h3>TechVault</h3>
                <p>Premium technology marketplace based in London. Founded by Adegboye Desmond & Adegboye Olusola. We believe in quality, transparency, and exceptional service.</p>
                <div class="social-links">
                    <a href="#">f</a>
                    <a href="#">t</a>
                    <a href="#">in</a>
                    <a href="#">ig</a>
                </div>
            </div>
            <div class="footer-links">
                <h4>Shop</h4>
                <ul>
                    <li><a href="#" onclick="showPage('laptops')">All Laptops</a></li>
                    <li><a href="#" onclick="showPage('phones')">All Phones</a></li>
                    <li><a href="#">New Arrivals</a></li>
                    <li><a href="#">Best Sellers</a></li>
                    <li><a href="#">Deals</a></li>
                </ul>
            </div>
            <div class="footer-links">
                <h4>Support</h4>
                <ul>
                    <li><a href="#" onclick="showPage('track')">Track Order</a></li>
                    <li><a href="https://wa.me/2347032386595">WhatsApp Support</a></li>
                    <li><a href="https://t.me/fajnigltd">Telegram</a></li>
                    <li><a href="#">Returns Policy</a></li>
                    <li><a href="#">Warranty Info</a></li>
                </ul>
            </div>
            <div class="footer-links">
                <h4>Contact</h4>
                <ul>
                    <li> 07032386595</li>
                    <li> @fajnigltd</li>
                    <li> London, United Kingdom</li>
                    <li> support@techvault.ng</li>
                    <li> Mon-Sat: 9AM - 6PM</li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 TechVault. Led by Adegboye Desmond & Olusola. All rights reserved.</p>
            <div class="payment-methods">
                <span></span>
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </footer>

    <script>
        // ==========================================
        // CONFIGURATION - REPLACE THESE VALUES
        // ==========================================
        
        // 1. SUPABASE CONFIGURATION
        // Get these from your Supabase project settings
        const SUPABASE_URL = 'https://your-project.supabase.co';
        const SUPABASE_ANON_KEY = 'your-anon-key';
        
        // 2. FLUTTERWAVE CONFIGURATION
        // Get your Public Key from Flutterwave Dashboard > Settings > API Keys
        // Use 'FLWPUBK_TEST-XXXXXXXXXXXXXXXXXXXXXXXXXXXX-X' for testing
        // Use 'FLWPUBK-XXXXXXXXXXXXXXXXXXXXXXXXXXXX-X' for live/production
        const FLUTTERWAVE_PUBLIC_KEY = 'FLWPUBK_TEST-XXXXXXXXXXXXXXXXXXXXXXXXXXXX-X'; 
        const IS_PAYMENT_LIVE = false; // Set to true when using live key

        // ==========================================
        // CURRENCY CONVERTER
        // ==========================================
        let currentCurrency = {
            code: 'NGN',
            symbol: '',
            rate: 1
        };

        // Exchange rates (approximate - update as needed)
        const exchangeRates = {
            'NGN': 1,
            'USD': 0.0013,
            'GBP': 0.0010,
            'EUR': 0.0012
        };

        function toggleCurrencyDropdown() {
            const dropdown = document.getElementById('currencyDropdown');
            dropdown.classList.toggle('active');
        }

        function changeCurrency(code, symbol, rate) {
            currentCurrency = { code, symbol, rate: exchangeRates[code] };
            
            // Update UI
            document.getElementById('currentCurrencySymbol').textContent = symbol;
            document.getElementById('currentCurrencyCode').textContent = code;
            
            // Update active state in dropdown
            document.querySelectorAll('.currency-option').forEach(opt => {
                opt.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
            
            // Close dropdown
            document.getElementById('currencyDropdown').classList.remove('active');
            
            // Refresh displays
            renderProducts();
            renderFeaturedProducts();
            updateCart();
            
            // Save preference
            localStorage.setItem('techvault_currency', JSON.stringify(currentCurrency));
            
            showToast(`Currency changed to ${code}`);
        }

        function formatPrice(priceInNaira) {
            const converted = priceInNaira * currentCurrency.rate;
            
            if (currentCurrency.code === 'NGN') {
                return `${priceInNaira.toLocaleString()}`;
            } else {
                return `${currentCurrency.symbol}${converted.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            }
        }

        function formatPriceWithConversion(priceInNaira) {
            const converted = priceInNaira * currentCurrency.rate;
            const formatted = currentCurrency.code === 'NGN' 
                ? `${priceInNaira.toLocaleString()}`
                : `${currentCurrency.symbol}${converted.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            
            return formatted;
        }

        // Load saved currency preference
        function loadCurrencyPreference() {
            const saved = localStorage.getItem('techvault_currency');
            if (saved) {
                currentCurrency = JSON.parse(saved);
                document.getElementById('currentCurrencySymbol').textContent = currentCurrency.symbol;
                document.getElementById('currentCurrencyCode').textContent = currentCurrency.code;
            }
        }

        // ==========================================
        // HELP CHAT SYSTEM
        // ==========================================
        const helpResponses = {
            'how-to-order': {
                title: 'How to Place an Order',
                message: ` <strong>Ordering is easy:</strong><br><br>
                1. Browse products & click "Add to Cart"<br>
                2. Click the cart icon (top right)<br>
                3. Review items & click "Checkout"<br>
                4. Fill your delivery details<br>
                5. Pay securely with Flutterwave<br>
                6. Receive order confirmation via email<br><br>
                Need help? Call 07032386595`
            },
            'track-order': {
                title: 'Track Your Order',
                message: ` <strong>Tracking Steps:</strong><br><br>
                1. Go to "Track Order" page<br>
                2. Enter your Order ID (e.g., TV-123456)<br>
                3. See real-time location & status<br><br>
                You'll receive GPS updates via WhatsApp too!<br>
                Order ID is in your confirmation email.`
            },
            'payment': {
                title: 'Payment Methods',
                message: ` <strong>We Accept:</strong><br><br>
                 <strong>Debit/Credit Cards</strong> (Visa, Mastercard, Verve)<br>
                 <strong>Bank Transfer</strong><br>
                 <strong>USSD</strong> (*123# etc)<br>
                 <strong>Mobile Money</strong><br>
                 <strong>Apple Pay</strong> & <strong>Google Pay</strong><br><br>
                <small>All payments secured by Flutterwave 256-bit SSL</small>`
            },
            'contact': {
                title: 'Contact Us',
                message: ` <strong>We're here to help!</strong><br><br>
                <strong>WhatsApp:</strong> 07032386595<br>
                <strong>Telegram:</strong> @fajnigltd<br>
                <strong>Email:</strong> support@techvault.ng<br>
                <strong>Location:</strong> London, UK<br><br>
                <strong>Hours:</strong> Mon-Sat 9AM-6PM<br>
                <em>Usually responds in 5 minutes!</em>`
            },
            'default': {
                title: 'Support',
                message: `Thanks for your message! For immediate assistance:<br><br>
                 <strong>WhatsApp:</strong> 07032386595<br>
                 <strong>Telegram:</strong> @fajnigltd<br><br>
                Our team (Desmond & Olusola) typically replies within 5 minutes during business hours.`
            }
        };

        function sendQuickMessage(type) {
            const response = helpResponses[type] || helpResponses['default'];
            
            // Add user message
            addMessage(response.title, 'sent');
            
            // Show typing indicator
            showTypingIndicator();
            
            // Send response after delay
            setTimeout(() => {
                removeTypingIndicator();
                addMessage(response.message, 'received');
            }, 1000);
        }

        function addMessage(text, type) {
            const messagesDiv = document.getElementById('chatMessages');
            const time = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            messageDiv.innerHTML = `
                <div>${text}</div>
                <div class="message-time">${time}</div>
            `;
            
            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        function showTypingIndicator() {
            const messagesDiv = document.getElementById('chatMessages');
            const typingDiv = document.createElement('div');
            typingDiv.id = 'typingIndicator';
            typingDiv.className = 'typing-indicator';
            typingDiv.innerHTML = `
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            `;
            messagesDiv.appendChild(typingDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        function removeTypingIndicator() {
            const indicator = document.getElementById('typingIndicator');
            if (indicator) indicator.remove();
        }

        // ==========================================
        // SUPABASE CONFIGURATION
        // ==========================================
        let supabaseClient;
        
        function initSupabase() {
            try {
                if (SUPABASE_URL.includes('your-project')) {
                    console.warn(' Please configure Supabase credentials');
                    return;
                }
                supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                console.log(' Supabase initialized');
                checkUser();
            } catch (error) {
                console.error(' Supabase init failed:', error);
            }
        }

        // ==========================================
        // FLUTTERWAVE PAYMENT (ACTIVE & READY)
        // ==========================================
        
        // Verify configuration on load
        window.addEventListener('load', () => {
            if (FLUTTERWAVE_PUBLIC_KEY.includes('XXXXXXXX')) {
                document.getElementById('flutterwaveConfigWarning').style.display = 'block';
                document.getElementById('payButton').textContent = 'Configure Payment First';
                document.getElementById('payButton').disabled = true;
                document.getElementById('payButton').style.opacity = '0.5';
            } else {
                console.log(' Flutterwave Ready');
                if (!IS_PAYMENT_LIVE) {
                    document.getElementById('paymentModeIndicator').classList.add('active');
                }
            }
            
            loadCurrencyPreference();
        });

        function openCheckout() {
            if (cart.length === 0) {
                showToast('Your cart is empty');
                return;
            }
            
            // Check if Flutterwave is configured
            if (FLUTTERWAVE_PUBLIC_KEY.includes('XXXXXXXX')) {
                showToast(' Payment not configured. Please add your Flutterwave keys.');
                return;
            }
            
            // Populate checkout items
            const checkoutItems = document.getElementById('checkoutItems');
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            checkoutItems.innerHTML = cart.map(item => `
                <div class="summary-item">
                    <span>${item.name} x${item.quantity}</span>
                    <span>${formatPrice(item.price * item.quantity)}</span>
                </div>
            `).join('');
            
            document.getElementById('checkoutTotal').textContent = formatPrice(total);
            document.getElementById('checkoutModal').classList.add('active');
            toggleCart();
        }

        async function initiatePayment(e) {
            e.preventDefault();
            
            const name = document.getElementById('customerName').value;
            const email = document.getElementById('customerEmail').value;
            const phone = document.getElementById('customerPhone').value;
            const address = document.getElementById('customerAddress').value;
            const city = document.getElementById('customerCity').value || 'London';
            const postal = document.getElementById('customerPostal').value || '';
            
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const tx_ref = `TV-${Date.now()}`;
            
            // Prepare order data
            const orderData = {
                order_id: tx_ref,
                customer_name: name,
                customer_email: email,
                customer_phone: phone,
                customer_address: `${address}, ${city}, ${postal}`,
                items: cart,
                total_amount: total,
                currency: 'NGN', // Always store in NGN
                status: 'pending',
                payment_status: 'pending',
                created_at: new Date().toISOString()
            };
            
            try {
                // Save to Supabase if available
                if (supabaseClient) {
                    const { data, error } = await supabaseClient
                        .from('orders')
                        .insert([orderData]);
                    if (error) throw error;
                } else {
                    // Local storage fallback
                    localStorage.setItem('pending_order_' + tx_ref, JSON.stringify(orderData));
                }
                
                // Initialize Flutterwave Checkout
                FlutterwaveCheckout({
                    public_key: FLUTTERWAVE_PUBLIC_KEY,
                    tx_ref: tx_ref,
                    amount: total,
                    currency: "NGN", // Flutterwave works best with NGN for Nigerian customers
                    country: "NG",
                    payment_options: "card, banktransfer, ussd, mobilemoney, account, mpesa",
                    customer: {
                        email: email,
                        phone_number: phone,
                        name: name,
                    },
                    customizations: {
                        title: "TechVault Pro",
                        description: "Payment for laptop/phone purchase",
                        logo: "https://techvault.ng/logo.png", // Replace with your logo
                    },
                    callback: function(data) {
                        console.log("Payment callback:", data);
                        if (data.status === "successful") {
                            verifyPayment(data, orderData);
                        } else {
                            showToast('Payment failed or cancelled');
                        }
                    },
                    onclose: function() {
                        // Don't show toast if payment was successful (already handled in callback)
                        console.log("Payment modal closed");
                    }
                });
                
            } catch (error) {
                console.error('Order creation failed:', error);
                showToast('Failed to initialize payment. Please try again.');
            }
        }

        async function verifyPayment(paymentData, orderData) {
            try {
                // Update order status
                const updateData = {
                    status: 'paid',
                    payment_status: 'completed',
                    payment_reference: paymentData.flw_ref,
                    transaction_id: paymentData.transaction_id,
                    paid_at: new Date().toISOString()
                };
                
                if (supabaseClient) {
                    const { error } = await supabaseClient
                        .from('orders')
                        .update(updateData)
                        .eq('order_id', orderData.order_id);
                    if (error) throw error;
                } else {
                    // Update local storage
                    orderData.status = 'paid';
                    orderData.payment_status = 'completed';
                    localStorage.setItem('order_' + orderData.order_id, JSON.stringify(orderData));
                    localStorage.removeItem('pending_order_' + orderData.order_id);
                }
                
                // Clear cart
                cart = [];
                saveCart();
                updateCart();
                closeCheckout();
                
                // Send WhatsApp notification simulation
                const message = `New Order ${orderData.order_id}! Total: ${orderData.total_amount}. Customer: ${orderData.customer_name}. Call: ${orderData.customer_phone}`;
                console.log('WhatsApp notification:', message);
                
                showToast(' Payment successful! Order confirmed.', 'success');
                
                // Redirect to tracking
                setTimeout(() => {
                    document.getElementById('trackingInput').value = orderData.order_id;
                    showPage('track');
                    trackOrder();
                }, 2000);
                
            } catch (error) {
                console.error('Verification error:', error);
                showToast('Payment received! We will verify shortly.');
            }
        }

        // ==========================================
        // EXISTING FUNCTIONS (All kept intact)
        // ==========================================

        function closeCheckout() {
            document.getElementById('checkoutModal').classList.remove('active');
        }

        function showPage(page) {
            document.getElementById('homePage').classList.remove('active');
            document.getElementById('homePage').style.display = 'none';
            document.getElementById('productsPage').classList.remove('active');
            document.getElementById('trackPage').classList.remove('active');
            document.getElementById('accountPage').classList.remove('active');

            if(page === 'home') {
                document.getElementById('homePage').style.display = 'block';
                setTimeout(() => document.getElementById('homePage').classList.add('active'), 10);
                window.scrollTo(0, 0);
            } else if(page === 'laptops') {
                document.getElementById('productsPage').classList.add('active');
                currentFilter = 'laptop';
                document.getElementById('pageTitle').textContent = 'Premium Laptops';
                renderProducts();
                window.scrollTo(0, 0);
            } else if(page === 'phones') {
                document.getElementById('productsPage').classList.add('active');
                currentFilter = 'phone';
                document.getElementById('pageTitle').textContent = 'Smartphones';
                renderProducts();
                window.scrollTo(0, 0);
            } else if(page === 'track') {
                document.getElementById('trackPage').classList.add('active');
                window.scrollTo(0, 0);
            } else if(page === 'account') {
                document.getElementById('accountPage').classList.add('active');
                window.scrollTo(0, 0);
            }
        }

        function renderProducts() {
            const grid = document.getElementById('productsGrid');
            let filtered = currentFilter === 'all' ? products : products.filter(p => p.category === currentFilter);
            
            if(currentSort === 'price-low') {
                filtered.sort((a, b) => a.price - b.price);
            } else if(currentSort === 'price-high') {
                filtered.sort((a, b) => b.price - a.price);
            } else if(currentSort === 'rating') {
                filtered.sort((a, b) => b.rating - a.rating);
            }

            document.getElementById('resultsCount').textContent = `Showing ${filtered.length} products`;
            grid.innerHTML = filtered.map(product => createProductCard(product)).join('');
        }

        function renderFeaturedProducts() {
            const featured = products.slice(0, 4);
            document.getElementById('featuredProducts').innerHTML = featured.map(product => createProductCard(product)).join('');
        }

        function createProductCard(product) {
            const isWishlisted = wishlist.includes(product.id);
            return `
                <div class="product-card">
                    ${product.badge ? `<span class="product-badge ${product.badge.toLowerCase().replace(' ', '-')}">${product.badge}</span>` : ''}
                    <button class="product-wishlist ${isWishlisted ? 'active' : ''}" onclick="toggleWishlistItem(${product.id}, event)">
                        ${isWishlisted ? '' : ''}
                    </button>
                    <div class="product-image-container" onclick="openProductModal(${product.id})">
                        <img src="${product.image}" alt="${product.name}" class="product-image">
                        <div class="product-quick-view">Quick View</div>
                    </div>
                    <div class="product-info">
                        <div class="product-brand">${product.brand}</div>
                        <h3 class="product-name" onclick="openProductModal(${product.id})">${product.name}</h3>
                        <div class="product-rating">
                            <span class="stars">${''.repeat(Math.floor(product.rating))}${''.repeat(5-Math.floor(product.rating))}</span>
                            <span class="rating-count">(${product.reviews})</span>
                        </div>
                        <p class="product-specs">${Object.values(product.specs)[0]}  ${Object.values(product.specs)[1]}</p>
                        <div class="product-footer">
                            <div class="product-price">
                                <span class="current-price">${formatPrice(product.price)}</span>
                                ${product.originalPrice ? `<span class="original-price">${formatPrice(product.originalPrice)}</span>` : ''}
                            </div>
                            <button class="add-to-cart-btn" onclick="addToCart(${product.id})" title="Add to Cart">
                                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function openProductModal(productId) {
            const product = products.find(p => p.id === productId);
            const modal = document.getElementById('productModal');
            const content = document.getElementById('productDetailContent');
            
            content.innerHTML = `
                <div class="product-gallery">
                    <img src="${product.image}" alt="${product.name}">
                </div>
                <div class="product-details">
                    <div class="detail-header">
                        <div class="product-brand">${product.brand}</div>
                        <h2 class="detail-title">${product.name}</h2>
                        <div class="detail-meta">
                            <span> ${product.rating} (${product.reviews} reviews)</span>
                            <span></span>
                            <span>${product.inStock ? ' In Stock' : 'Out of Stock'}</span>
                            <span></span>
                            <span>SKU: TV-${product.id}00${product.id}</span>
                        </div>
                    </div>
                    
                    <div class="detail-price">${formatPrice(product.price)}</div>
                    
                    <p style="color: var(--gray); line-height: 1.8; margin-bottom: 2rem;">${product.description}</p>
                    
                    <div class="detail-actions">
                        <div class="quantity-selector">
                            <button class="qty-btn" onclick="adjustModalQty(-1)"></button>
                            <span class="qty-value" id="modalQty">1</span>
                            <button class="qty-btn" onclick="adjustModalQty(1)">+</button>
                        </div>
                        <button class="btn btn-primary" style="flex: 1;" onclick="addToCartFromModal(${product.id})">
                            Add to Cart - ${formatPrice(product.price)}
                        </button>
                        <button class="btn btn-outline" onclick="addToCompare(${product.id})">
                            Compare
                        </button>
                    </div>

                    <div style="margin: 2rem 0;">
                        <h4 style="margin-bottom: 1rem;">Key Specifications</h4>
                        <table class="specs-table">
                            ${Object.entries(product.specs).map(([key, value]) => `
                                <tr>
                                    <td>${key.charAt(0).toUpperCase() + key.slice(1)}</td>
                                    <td>${value}</td>
                                </tr>
                            `).join('')}
                        </table>
                    </div>

                    <div class="reviews-section">
                        <h4 style="margin-bottom: 1rem;">Customer Reviews</h4>
                        <div class="review-card">
                            <div class="review-header">
                                <div class="reviewer">
                                    <div class="reviewer-avatar">JD</div>
                                    <div class="reviewer-info">
                                        <h4>John Doe</h4>
                                        <p>Verified Buyer  2 days ago</p>
                                    </div>
                                </div>
                                <span class="stars"></span>
                            </div>
                            <p>Amazing product! Fast delivery and excellent quality. Desmond was very helpful in answering my questions before purchase.</p>
                        </div>
                    </div>
                </div>
            `;
            
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeProductModal() {
            document.getElementById('productModal').classList.remove('active');
            document.body.style.overflow = '';
        }

        let modalQuantity = 1;
        function adjustModalQty(change) {
            modalQuantity = Math.max(1, modalQuantity + change);
            document.getElementById('modalQty').textContent = modalQuantity;
        }

        function addToCartFromModal(productId) {
            const product = products.find(p => p.id === productId);
            for(let i = 0; i < modalQuantity; i++) {
                addToCart(productId, false);
            }
            closeProductModal();
            showToast(`Added ${modalQuantity} ${product.name} to cart!`);
            modalQuantity = 1;
        }

        function setupSearch() {
            const searchInput = document.getElementById('searchInput');
            const searchResults = document.getElementById('searchResults');
            
            searchInput.addEventListener('focus', () => {
                if(searchInput.value.length > 0) searchResults.classList.add('active');
            });
            
            document.addEventListener('click', (e) => {
                if(!e.target.closest('.search-box')) {
                    searchResults.classList.remove('active');
                }
            });
        }

        function handleSearch(query) {
            const resultsDiv = document.getElementById('searchResults');
            
            if(query.length < 2) {
                resultsDiv.classList.remove('active');
                return;
            }
            
            const filtered = products.filter(p => 
                p.name.toLowerCase().includes(query.toLowerCase()) ||
                p.brand.toLowerCase().includes(query.toLowerCase()) ||
                p.category.toLowerCase().includes(query.toLowerCase())
            ).slice(0, 5);
            
            if(filtered.length > 0) {
                resultsDiv.innerHTML = filtered.map(product => `
                    <div class="search-item" onclick="openProductModal(${product.id}); document.getElementById('searchResults').classList.remove('active')">
                        <img src="${product.image}" alt="${product.name}">
                        <div>
                            <div style="font-weight: 600;">${product.name}</div>
                            <div style="font-size: 0.875rem; color: var(--gray);">${formatPrice(product.price)}</div>
                        </div>
                    </div>
                `).join('');
                resultsResults.classList.add('active');
            } else {
                resultsDiv.innerHTML = '<div class="search-item" style="color: var(--gray);">No products found</div>';
                resultsDiv.classList.add('active');
            }
        }

        function addToCart(productId, showNotification = true) {
            const product = products.find(p => p.id === productId);
            const existingItem = cart.find(item => item.id === productId);
            
            if(existingItem) {
                existingItem.quantity++;
            } else {
                cart.push({ ...product, quantity: 1 });
            }
            
            saveCart();
            updateCart();
            if(showNotification) showToast(`${product.name} added to cart!`);
        }

        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            saveCart();
            updateCart();
        }

        function updateQuantity(productId, change) {
            const item = cart.find(item => item.id === productId);
            if(item) {
                item.quantity += change;
                if(item.quantity <= 0) {
                    removeFromCart(productId);
                } else {
                    saveCart();
                    updateCart();
                }
            }
        }

        function saveCart() {
            localStorage.setItem('techvault_cart', JSON.stringify(cart));
        }

        function updateCart() {
            const cartCount = document.getElementById('cartCount');
            const cartItems = document.getElementById('cartItems');
            const cartFooter = document.getElementById('cartFooter');
            
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            cartCount.textContent = totalItems;
            
            if(cart.length === 0) {
                cartItems.innerHTML = `
                    <div style="text-align: center; padding: 4rem 2rem;">
                        <div style="font-size: 4rem; margin-bottom: 1rem;"></div>
                        <h3>Your cart is empty</h3>
                        <p style="color: var(--gray); margin: 1rem 0;">Add some premium tech to get started</p>
                        <button class="btn btn-primary" onclick="toggleCart(); showPage('laptops')">Start Shopping</button>
                    </div>
                `;
                cartFooter.style.display = 'none';
            } else {
                cartItems.innerHTML = cart.map(item => `
                    <div class="cart-item">
                        <img src="${item.image}" alt="${item.name}" class="cart-item-image">
                        <div class="cart-item-details">
                            <div class="cart-item-title">${item.name}</div>
                            <div class="cart-item-variant">${item.specs.processor || item.specs.display}</div>
                            <div class="cart-item-price">${formatPrice(item.price)}</div>
                            <div class="cart-item-actions">
                                <button class="qty-btn" onclick="updateQuantity(${item.id}, -1)"></button>
                                <span style="font-weight: 600; min-width: 30px; text-align: center;">${item.quantity}</span>
                                <button class="qty-btn" onclick="updateQuantity(${item.id}, 1)">+</button>
                                <button class="icon-btn" onclick="removeFromCart(${item.id})" style="margin-left: auto; color: var(--gray);">
                                    <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
                
                document.getElementById('cartSubtotal').textContent = formatPrice(subtotal);
                document.getElementById('cartTotal').textContent = formatPrice(subtotal);
                cartFooter.style.display = 'block';
            }
        }

        function toggleCart() {
            const sidebar = document.getElementById('cartSidebar');
            const overlay = document.getElementById('cartOverlay');
            const isOpen = sidebar.classList.contains('active');
            
            if(isOpen) {
                sidebar.classList.remove('active');
                overlay.classList.remove('active');
                document.body.style.overflow = '';
            } else {
                sidebar.classList.add('active');
                overlay.classList.add('active');
                document.body.style.overflow = 'hidden';
                updateCart();
            }
        }

        function toggleWishlistItem(productId, event) {
            event.stopPropagation();
            const index = wishlist.indexOf(productId);
            
            if(index > -1) {
                wishlist.splice(index, 1);
                showToast('Removed from wishlist');
            } else {
                wishlist.push(productId);
                showToast('Added to wishlist! ');
            }
            
            localStorage.setItem('techvault_wishlist', JSON.stringify(wishlist));
            updateWishlist();
            renderProducts();
            renderFeaturedProducts();
        }

        function updateWishlist() {
            document.getElementById('wishlistCount').textContent = wishlist.length;
        }

        function toggleWishlist() {
            if(wishlist.length === 0) {
                showToast('Your wishlist is empty');
                return;
            }
            showPage('account');
            showAccountTab('wishlist');
        }

        function addToCompare(productId) {
            if(compareList.includes(productId)) {
                showToast('Already in compare list');
                return;
            }
            
            if(compareList.length >= 3) {
                showToast('You can compare up to 3 products');
                return;
            }
            
            compareList.push(productId);
            updateCompareBar();
            showToast('Added to comparison');
        }

        function updateCompareBar() {
            const bar = document.getElementById('compareBar');
            const itemsDiv = document.getElementById('compareItems');
            const count = document.getElementById('compareCount');
            
            count.textContent = compareList.length;
            
            if(compareList.length > 0) {
                bar.classList.add('active');
                itemsDiv.innerHTML = compareList.map(id => {
                    const product = products.find(p => p.id === id);
                    return `<img src="${product.image}" class="compare-thumb" title="${product.name}" onclick="removeFromCompare(${id})" style="cursor: pointer;">`;
                }).join('');
            } else {
                bar.classList.remove('active');
            }
        }

        function removeFromCompare(productId) {
            compareList = compareList.filter(id => id !== productId);
            updateCompareBar();
        }

        function clearCompare() {
            compareList = [];
            updateCompareBar();
        }

        function showComparison() {
            if(compareList.length < 2) {
                showToast('Add at least 2 products to compare');
                return;
            }
            
            const compareProducts = compareList.map(id => products.find(p => p.id === id));
            let html = '<div style="padding: 2rem;"><h2 style="margin-bottom: 2rem;">Product Comparison</h2><div style="display: grid; grid-template-columns: repeat(' + compareProducts.length + ', 1fr); gap: 2rem;">';
            
            compareProducts.forEach(p => {
                html += `<div style="text-align: center;">
                    <img src="${p.image}" style="width: 100%; max-width: 200px; border-radius: 12px; margin-bottom: 1rem;">
                    <h3>${p.name}</h3>
                    <div style="font-size: 1.5rem; font-weight: 700; color: var(--accent); margin: 1rem 0;">${formatPrice(p.price)}</div>
                    <button class="btn btn-primary btn-sm" onclick="addToCart(${p.id})">Add to Cart</button>
                </div>`;
            });
            
            html += '</div><table style="width: 100%; margin-top: 3rem; border-collapse: collapse;">';
            
            const specs = Object.keys(compareProducts[0].specs);
            specs.forEach(spec => {
                html += `<tr style="border-bottom: 1px solid var(--border);">
                    <td style="padding: 1rem; font-weight: 600; text-transform: capitalize;">${spec}</td>`;
                compareProducts.forEach(p => {
                    html += `<td style="padding: 1rem;">${p.specs[spec]}</td>`;
                });
                html += '</tr>';
            });
            
            html += '</table></div>';
            
            document.getElementById('productDetailContent').innerHTML = html;
            document.getElementById('productModal').classList.add('active');
        }

        function toggleChat() {
            const chatWindow = document.getElementById('chatWindow');
            chatWindow.classList.toggle('active');
        }

        function handleChatKey(event) {
            if(event.key === 'Enter') sendMessage();
        }

        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            if(!message) return;
            
            addMessage(message, 'sent');
            input.value = '';
            
            // Show typing
            showTypingIndicator();
            
            // Auto-reply logic
            setTimeout(() => {
                removeTypingIndicator();
                
                let response = helpResponses['default'];
                const lowerMsg = message.toLowerCase();
                
                if(lowerMsg.includes('order') || lowerMsg.includes('buy')) response = helpResponses['how-to-order'];
                else if(lowerMsg.includes('track') || lowerMsg.includes('where')) response = helpResponses['track-order'];
                else if(lowerMsg.includes('pay') || lowerMsg.includes('card') || lowerMsg.includes('money')) response = helpResponses['payment'];
                else if(lowerMsg.includes('contact') || lowerMsg.includes('call') || lowerMsg.includes('phone')) response = helpResponses['contact'];
                else if(lowerMsg.includes('hello') || lowerMsg.includes('hi')) {
                    response = {
                        title: 'Hello!',
                        message: ' Hi there! Welcome to TechVault. How can I help you today? Choose a quick option above or ask me anything!'
                    };
                }
                
                addMessage(response.message, 'received');
            }, 1500);
        }

        function showToast(message, type = 'normal') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            const toastIcon = document.getElementById('toastIcon');
            
            toastMessage.textContent = message;
            toastIcon.textContent = type === 'success' ? '' : '';
            toast.className = 'toast show' + (type === 'success' ? ' success' : '');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        function setupScrollEffect() {
            const header = document.getElementById('header');
            window.addEventListener('scroll', () => {
                if(window.scrollY > 100) {
                    header.classList.add('scrolled');
                } else {
                    header.classList.remove('scrolled');
                }
            });
        }

        function toggleCategory(cat) {
            currentFilter = cat;
            renderProducts();
        }

        function sortProducts(sortType) {
            currentSort = sortType;
            renderProducts();
        }

        function renderBrandFilters() {
            const brands = [...new Set(products.map(p => p.brand))];
            document.getElementById('brandFilters').innerHTML = brands.map(brand => `
                <label class="filter-option">
                    <input type="checkbox" onchange="filterByBrand('${brand}')">
                    <span>${brand}</span>
                </label>
            `).join('');
        }

        function filterByBrand(brand) {
            showToast(`Filtered by ${brand}`);
        }

        function applyPriceFilter() {
            const min = document.getElementById('minPrice').value;
            const max = document.getElementById('maxPrice').value;
            showToast(`Price filter: ${min || 0} - ${max || ''}`);
        }

        function filterByRating(minRating) {
            showToast(`Showing ${minRating} and above`);
        }

        function showAccountTab(tab) {
            const content = document.getElementById('accountContent');
            document.querySelectorAll('.account-menu a').forEach(a => a.classList.remove('active'));
            event.target.classList.add('active');
            
            if(tab === 'wishlist') {
                if(wishlist.length === 0) {
                    content.innerHTML = '<h2>My Wishlist</h2><p style="color: var(--gray); margin-top: 2rem;">Your wishlist is empty. Start adding products you love!</p>';
                } else {
                    const wishlistProducts = products.filter(p => wishlist.includes(p.id));
                    content.innerHTML = '<h2 style="margin-bottom: 2rem;">My Wishlist</h2><div class="products-grid">' + wishlistProducts.map(p => createProductCard(p)).join('') + '</div>';
                }
            } else if(tab === 'orders') {
                content.innerHTML = `<h2 style="margin-bottom: 2rem;">My Orders</h2><div id="ordersList" class="orders-list"></div>`;
                loadUserOrders();
            } else {
                content.innerHTML = `<h2>${tab.charAt(0).toUpperCase() + tab.slice(1)}</h2><p style="color: var(--gray); margin-top: 2rem;">This section is coming soon.</p>`;
            }
        }

        // Close dropdowns when clicking outside
        document.addEventListener('click', (e) => {
            if(!e.target.closest('.currency-converter')) {
                document.getElementById('currencyDropdown').classList.remove('active');
            }
        });

        document.addEventListener('keydown', (e) => {
            if(e.key === 'Escape') {
                closeProductModal();
                closeCheckout();
                document.getElementById('cartSidebar').classList.remove('active');
                document.getElementById('cartOverlay').classList.remove('active');
                document.getElementById('chatWindow').classList.remove('active');
                document.body.style.overflow = '';
            }
        });

        // ==========================================
        // PRODUCT DATABASE (30 Products)
        // ==========================================
        const products = [
            // LAPTOPS (15)
            {
                id: 1,
                name: "MacBook Air M2",
                category: "laptop",
                brand: "Apple",
                price: 950000,
                originalPrice: 1100000,
                image: "https://images.unsplash.com/photo-1611186871348-b1ce696e52c9?w=600&h=400&fit=crop",
                gallery: [
                    "https://images.unsplash.com/photo-1611186871348-b1ce696e52c9?w=600&h=400&fit=crop",
                    "https://images.unsplash.com/photo-1517336714731-489689fd1ca8?w=600&h=400&fit=crop"
                ],
                specs: {
                    processor: "Apple M2 chip",
                    ram: "8GB Unified Memory",
                    storage: "256GB SSD",
                    display: "13.6-inch Liquid Retina",
                    battery: "Up to 18 hours",
                    weight: "1.24 kg"
                },
                description: "Supercharged by M2. Strikingly thin and fast so you can work, play, or create just about anything  anywhere.",
                rating: 4.9,
                reviews: 128,
                badge: "Best Seller",
                inStock: true
            },
            {
                id: 2,
                name: "MacBook Pro 14 M2 Pro",
                category: "laptop",
                brand: "Apple",
                price: 1450000,
                originalPrice: 1650000,
                image: "https://images.unsplash.com/photo-1517336714731-489689fd1ca8?w=600&h=400&fit=crop",
                specs: { processor: "M2 Pro", ram: "16GB", storage: "512GB SSD", display: "14.2-inch XDR", battery: "18 hours", weight: "1.6 kg" },
                description: "The most advanced Mac laptops for demanding workflows.",
                rating: 4.9,
                reviews: 89,
                badge: "Pro Choice",
                inStock: true
            },
            {
                id: 3,
                name: "Dell XPS 13 Plus",
                category: "laptop",
                brand: "Dell",
                price: 780000,
                originalPrice: 920000,
                image: "https://images.unsplash.com/photo-1593642632823-8f78536788c6?w=600&h=400&fit=crop",
                specs: { processor: "Intel i7-1260P", ram: "16GB", storage: "512GB SSD", display: "13.4-inch OLED Touch", battery: "12 hours", weight: "1.26 kg" },
                description: "Modern design with seamless glass touchpad and capacitive touch function row.",
                rating: 4.7,
                reviews: 64,
                badge: "Premium",
                inStock: true
            },
            {
                id: 4,
                name: "Dell XPS 15",
                category: "laptop",
                brand: "Dell",
                price: 920000,
                originalPrice: 1100000,
                image: "https://images.unsplash.com/photo-1588872657578-7efd1f1555ed?w=600&h=400&fit=crop",
                specs: { processor: "Intel i7-12700H", ram: "16GB", storage: "1TB SSD", display: "15.6-inch FHD+", battery: "13 hours", weight: "1.86 kg" },
                description: "Powerhouse performance with stunning InfinityEdge display.",
                rating: 4.8,
                reviews: 52,
                badge: null,
                inStock: true
            },
            {
                id: 5,
                name: "HP Spectre x360",
                category: "laptop",
                brand: "HP",
                price: 680000,
                originalPrice: 820000,
                image: "https://images.unsplash.com/photo-1544731612-de7f96afe55f?w=600&h=400&fit=crop",
                specs: { processor: "Intel i7-1255U", ram: "16GB", storage: "512GB SSD", display: "13.5-inch 3K2K Touch", battery: "16 hours", weight: "1.36 kg" },
                description: "Convertible elegance meets powerhouse performance.",
                rating: 4.6,
                reviews: 43,
                badge: "2-in-1",
                inStock: true
            },
            {
                id: 6,
                name: "HP Envy 16",
                category: "laptop",
                brand: "HP",
                price: 750000,
                originalPrice: 890000,
                image: "https://images.unsplash.com/photo-1589561084283-930aa7b1ce50?w=600&h=400&fit=crop",
                specs: { processor: "Intel i7-12700H", ram: "16GB", storage: "1TB SSD", display: "16-inch 2.5K", battery: "11 hours", weight: "2.1 kg" },
                description: "Create on-the-go with RTX 3060 graphics and color-accurate display.",
                rating: 4.7,
                reviews: 38,
                badge: "Creator",
                inStock: true
            },
            {
                id: 7,
                name: "Lenovo ThinkPad X1 Carbon Gen 10",
                category: "laptop",
                brand: "Lenovo",
                price: 850000,
                originalPrice: 980000,
                image: "https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=600&h=400&fit=crop",
                specs: { processor: "Intel i7-1265U", ram: "16GB", storage: "512GB SSD", display: "14-inch 4K", battery: "15 hours", weight: "1.12 kg" },
                description: "Ultralight business powerhouse with legendary ThinkPad reliability.",
                rating: 4.8,
                reviews: 156,
                badge: "Business",
                inStock: true
            },
            {
                id: 8,
                name: "Lenovo Yoga 9i",
                category: "laptop",
                brand: "Lenovo",
                price: 720000,
                originalPrice: 850000,
                image: "https://images.unsplash.com/photo-1527434065213-849f5e9607ea?w=600&h=400&fit=crop",
                specs: { processor: "Intel i7-1260P", ram: "16GB", storage: "1TB SSD", display: "14-inch OLED 4K", battery: "14 hours", weight: "1.4 kg" },
                description: "Premium 2-in-1 with rotating soundbar hinge for immersive audio.",
                rating: 4.7,
                reviews: 47,
                badge: "Convertible",
                inStock: true
            },
            {
                id: 9,
                name: "ASUS ZenBook Pro 14 Duo",
                category: "laptop",
                brand: "ASUS",
                price: 820000,
                originalPrice: 950000,
                image: "https://images.unsplash.com/photo-1618411641110-6250b6e3f7c5?w=600&h=400&fit=crop",
                specs: { processor: "Intel i9-12900H", ram: "32GB", storage: "1TB SSD", display: "14.5-inch 2.8K OLED + ScreenPad", battery: "9 hours", weight: "1.75 kg" },
                description: "Dual-screen innovation for creative professionals.",
                rating: 4.6,
                reviews: 29,
                badge: "Innovation",
                inStock: true
            },
            {
                id: 10,
                name: "ASUS ROG Zephyrus G14",
                category: "laptop",
                brand: "ASUS",
                price: 980000,
                originalPrice: 1150000,
                image: "https://images.unsplash.com/photo-1603302576837-37561b2e2312?w=600&h=400&fit=crop",
                specs: { processor: "AMD Ryzen 9 6900HS", ram: "16GB", storage: "1TB SSD", display: "14-inch 120Hz QHD", battery: "10 hours", weight: "1.72 kg" },
                description: "Compact gaming powerhouse with AniMe Matrix display.",
                rating: 4.8,
                reviews: 92,
                badge: "Gaming",
                inStock: true
            },
            {
                id: 11,
                name: "Microsoft Surface Laptop 5",
                category: "laptop",
                brand: "Microsoft",
                price: 650000,
                originalPrice: 780000,
                image: "https://images.unsplash.com/photo-1531297484001-80022131f5a1?w=600&h=400&fit=crop",
                specs: { processor: "Intel i7-1255U", ram: "16GB", storage: "512GB SSD", display: "13.5-inch PixelSense Touch", battery: "18 hours", weight: "1.27 kg" },
                description: "Sleek design meets Windows 11 perfection.",
                rating: 4.6,
                reviews: 67,
                badge: null,
                inStock: true
            },
            {
                id: 12,
                name: "Acer Swift 5",
                category: "laptop",
                brand: "Acer",
                price: 580000,
                originalPrice: 690000,
                image: "https://images.unsplash.com/photo-1588872657578-7efd1f1555ed?w=600&h=400&fit=crop",
                specs: { processor: "Intel i7-1260P", ram: "16GB", storage: "1TB SSD", display: "14-inch Touch", battery: "12 hours", weight: "1.2 kg" },
                description: "Ultralight antimicrobial design for mobile professionals.",
                rating: 4.5,
                reviews: 34,
                badge: "Ultralight",
                inStock: true
            },
            {
                id: 13,
                name: "Razer Blade 15",
                category: "laptop",
                brand: "Razer",
                price: 1350000,
                originalPrice: 1550000,
                image: "https://images.unsplash.com/photo-1525547719571-a2d4ac8945e2?w=600&h=400&fit=crop",
                specs: { processor: "Intel i7-12800H", ram: "16GB", storage: "1TB SSD", display: "15.6-inch 240Hz QHD", battery: "6 hours", weight: "2.01 kg" },
                description: "The ultimate premium gaming laptop with CNC aluminum chassis.",
                rating: 4.7,
                reviews: 78,
                badge: "Premium",
                inStock: true
            },
            {
                id: 14,
                name: "LG Gram 17",
                category: "laptop",
                brand: "LG",
                price: 780000,
                originalPrice: 920000,
                image: "https://images.unsplash.com/photo-1517336714731-489689fd1ca8?w=600&h=400&fit=crop",
                specs: { processor: "Intel i7-1260P", ram: "16GB", storage: "1TB SSD", display: "17-inch WQXGA", battery: "19 hours", weight: "1.35 kg" },
                description: "Impossibly light 17-inch laptop for maximum productivity.",
                rating: 4.6,
                reviews: 41,
                badge: "Lightweight",
                inStock: true
            },
            {
                id: 15,
                name: "Samsung Galaxy Book3 Ultra",
                category: "laptop",
                brand: "Samsung",
                price: 1120000,
                originalPrice: 1300000,
                image: "https://images.unsplash.com/photo-1531297424006-640b3dbde7ed?w=600&h=400&fit=crop",
                specs: { processor: "Intel i9-13900H", ram: "32GB", storage: "1TB SSD", display: "16-inch 3K AMOLED 120Hz", battery: "14 hours", weight: "1.79 kg" },
                description: "Samsung's most powerful Galaxy Book with RTX 4070.",
                rating: 4.8,
                reviews: 23,
                badge: "New",
                inStock: true
            },

            // PHONES (15)
            {
                id: 16,
                name: "iPhone 15 Pro Max",
                category: "phone",
                brand: "Apple",
                price: 1250000,
                originalPrice: 1450000,
                image: "https://images.unsplash.com/photo-1696446701796-da61225697cc?w=600&h=400&fit=crop",
                specs: { display: "6.7-inch Super Retina XDR", processor: "A17 Pro", camera: "48MP Main + 5x Telephoto", storage: "256GB", battery: "29 hours video", weight: "221g" },
                description: "Titanium design. A17 Pro chip. Action button. 5x Telephoto camera.",
                rating: 4.9,
                reviews: 234,
                badge: "Latest",
                inStock: true
            },
            {
                id: 17,
                name: "iPhone 15 Pro",
                category: "phone",
                brand: "Apple",
                price: 1100000,
                originalPrice: 1300000,
                image: "https://images.unsplash.com/photo-1695048133142-1a20484d2569?w=600&h=400&fit=crop",
                specs: { display: "6.1-inch Super Retina XDR", processor: "A17 Pro", camera: "48MP Main + 3x Telephoto", storage: "128GB", battery: "23 hours video", weight: "187g" },
                description: "The most powerful iPhone with titanium design.",
                rating: 4.9,
                reviews: 189,
                badge: "Flagship",
                inStock: true
            },
            {
                id: 18,
                name: "iPhone 14 Pro Max",
                category: "phone",
                brand: "Apple",
                price: 950000,
                originalPrice: 1150000,
                image: "https://images.unsplash.com/photo-1678685888221-cda773a3dcdb?w=600&h=400&fit=crop",
                specs: { display: "6.7-inch Super Retina XDR", processor: "A16 Bionic", camera: "48MP Main", storage: "256GB", battery: "29 hours video", weight: "240g" },
                description: "Dynamic Island. 48MP Main camera. A16 Bionic chip.",
                rating: 4.8,
                reviews: 312,
                badge: "Value",
                inStock: true
            },
            {
                id: 19,
                name: "Samsung Galaxy S24 Ultra",
                category: "phone",
                brand: "Samsung",
                price: 1180000,
                originalPrice: 1400000,
                image: "https://images.unsplash.com/photo-1610945265078-3858a0828671?w=600&h=400&fit=crop",
                specs: { display: "6.8-inch QHD+ AMOLED 120Hz", processor: "Snapdragon 8 Gen 3", camera: "200MP Main + 10x Zoom", storage: "256GB", battery: "5000mAh", weight: "233g" },
                description: "Galaxy AI is here. Titanium frame. S Pen included. 200MP camera.",
                rating: 4.8,
                reviews: 156,
                badge: "AI Powered",
                inStock: true
            },
            {
                id: 20,
                name: "Samsung Galaxy S24+",
                category: "phone",
                brand: "Samsung",
                price: 920000,
                originalPrice: 1100000,
                image: "https://images.unsplash.com/photo-1610945415295-d9bbf067e59c?w=600&h=400&fit=crop",
                specs: { display: "6.7-inch QHD+ AMOLED 120Hz", processor: "Snapdragon 8 Gen 3", camera: "50MP Main + 3x Zoom", storage: "256GB", battery: "4900mAh", weight: "196g" },
                description: "Larger screen. Galaxy AI. All-day battery.",
                rating: 4.7,
                reviews: 89,
                badge: null,
                inStock: true
            },
            {
                id: 21,
                name: "Samsung Galaxy Z Fold 5",
                category: "phone",
                brand: "Samsung",
                price: 1380000,
                originalPrice: 1650000,
                image: "https://images.unsplash.com/photo-1660463974715-31cf9d9a497a?w=600&h=400&fit=crop",
                specs: { display: "7.6-inch Main + 6.2-inch Cover", processor: "Snapdragon 8 Gen 2", camera: "50MP Main", storage: "512GB", battery: "4400mAh", weight: "253g" },
                description: "The most powerful foldable. PC-like power in your pocket.",
                rating: 4.6,
                reviews: 67,
                badge: "Foldable",
                inStock: true
            },
            {
                id: 22,
                name: "Google Pixel 8 Pro",
                category: "phone",
                brand: "Google",
                price: 780000,
                originalPrice: 950000,
                image: "https://images.unsplash.com/photo-1598327105666-5b89351aff23?w=600&h=400&fit=crop",
                specs: { display: "6.7-inch LTPO OLED 120Hz", processor: "Google Tensor G3", camera: "50MP Main + 5x Telephoto", storage: "128GB", battery: "5050mAh", weight: "213g" },
                description: "The best of Google. AI-powered camera. 7 years of updates.",
                rating: 4.7,
                reviews: 94,
                badge: "Camera King",
                inStock: true
            },
            {
                id: 23,
                name: "Google Pixel 8",
                category: "phone",
                brand: "Google",
                price: 580000,
                originalPrice: 720000,
                image: "https://images.unsplash.com/photo-1598327105666-5b89351aff23?w=600&h=400&fit=crop",
                specs: { display: "6.2-inch OLED 120Hz", processor: "Google Tensor G3", camera: "50MP Main", storage: "128GB", battery: "4575mAh", weight: "187g" },
                description: "Compact powerhouse with best-in-class camera.",
                rating: 4.6,
                reviews: 78,
                badge: "Compact",
                inStock: true
            },
            {
                id: 24,
                name: "OnePlus 12",
                category: "phone",
                brand: "OnePlus",
                price: 720000,
                originalPrice: 850000,
                image: "https://images.unsplash.com/photo-1660463974715-31cf9d9a497a?w=600&h=400&fit=crop",
                specs: { display: "6.82-inch AMOLED 120Hz", processor: "Snapdragon 8 Gen 3", camera: "50MP Main + 3x Periscope", storage: "256GB", battery: "5400mAh", weight: "220g" },
                description: "100W charging. Hasselblad camera. Smooth performance.",
                rating: 4.7,
                reviews: 45,
                badge: "Fast Charge",
                inStock: true
            },
            {
                id: 25,
                name: "Xiaomi 14 Ultra",
                category: "phone",
                brand: "Xiaomi",
                price: 980000,
                originalPrice: 1200000,
                image: "https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?w=600&h=400&fit=crop",
                specs: { display: "6.73-inch AMOLED 120Hz", processor: "Snapdragon 8 Gen 3", camera: "50MP Leica Quad Camera", storage: "512GB", battery: "5000mAh", weight: "220g" },
                description: "Leica optics. Professional photography in your pocket.",
                rating: 4.5,
                reviews: 34,
                badge: "Photography",
                inStock: true
            },
            {
                id: 26,
                name: "iPhone 13",
                category: "phone",
                brand: "Apple",
                price: 480000,
                originalPrice: 650000,
                image: "https://images.unsplash.com/photo-1632661674596-df8be070a5c5?w=600&h=400&fit=crop",
                specs: { display: "6.1-inch Super Retina XDR", processor: "A15 Bionic", camera: "Dual 12MP", storage: "128GB", battery: "19 hours video", weight: "173g" },
                description: "Still an incredible iPhone with amazing camera and battery life.",
                rating: 4.7,
                reviews: 456,
                badge: "Best Value",
                inStock: true
            },
            {
                id: 27,
                name: "Samsung Galaxy A54 5G",
                category: "phone",
                brand: "Samsung",
                price: 280000,
                originalPrice: 350000,
                image: "https://images.unsplash.com/photo-1610945264803-c22b62d2a7b3?w=600&h=400&fit=crop",
                specs: { display: "6.4-inch AMOLED 120Hz", processor: "Exynos 1380", camera: "50MP Main", storage: "128GB", battery: "5000mAh", weight: "202g" },
                description: "Premium features at mid-range price. IP67 water resistant.",
                rating: 4.5,
                reviews: 123,
                badge: "Mid-Range",
                inStock: true
            },
            {
                id: 28,
                name: "Nothing Phone 2",
                category: "phone",
                brand: "Nothing",
                price: 520000,
                originalPrice: 650000,
                image: "https://images.unsplash.com/photo-1660463974715-31cf9d9a497a?w=600&h=400&fit=crop",
                specs: { display: "6.7-inch LTPO OLED 120Hz", processor: "Snapdragon 8+ Gen 1", camera: "50MP Dual", storage: "256GB", battery: "4700mAh", weight: "201g" },
                description: "Unique Glyph Interface. Pure Nothing OS experience.",
                rating: 4.4,
                reviews: 56,
                badge: "Unique",
                inStock: true
            },
            {
                id: 29,
                name: "Sony Xperia 1 V",
                category: "phone",
                brand: "Sony",
                price: 980000,
                originalPrice: 1200000,
                image: "https://images.unsplash.com/photo-1592899677977-9c10ca588bbd?w=600&h=400&fit=crop",
                specs: { display: "6.5-inch 4K HDR OLED 120Hz", processor: "Snapdragon 8 Gen 2", camera: "48MP Exmor T", storage: "256GB", battery: "5000mAh", weight: "187g" },
                description: "True optical zoom. 4K display. For creators.",
                rating: 4.6,
                reviews: 28,
                badge: "Creator",
                inStock: true
            },
            {
                id: 30,
                name: "Motorola Edge 40 Pro",
                category: "phone",
                brand: "Motorola",
                price: 450000,
                originalPrice: 580000,
                image: "https://images.unsplash.com/photo-1598327105666-5b89351aff23?w=600&h=400&fit=crop",
                specs: { display: "6.67-inch pOLED 165Hz", processor: "Snapdragon 8 Gen 2", camera: "50MP Main", storage: "256GB", battery: "4600mAh", weight: "196g" },
                description: "165Hz display. 125W charging. Ready for gaming.",
                rating: 4.3,
                reviews: 42,
                badge: "Gaming",
                inStock: true
            }
        ];

        // State
        let cart = JSON.parse(localStorage.getItem('techvault_cart')) || [];
        let wishlist = JSON.parse(localStorage.getItem('techvault_wishlist')) || [];
        let compareList = [];
        let currentFilter = 'all';
        let currentSort = 'featured';
        let currentUser = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initSupabase();
            renderFeaturedProducts();
            updateCart();
            updateWishlist();
            setupScrollEffect();
            setupSearch();
            renderBrandFilters();
            loadUserOrders();
            loadCurrencyPreference();
        });

        // ==========================================
        // ORDER TRACKING (FROM SUPABASE)
        // ==========================================

        async function trackOrder() {
            const input = document.getElementById('trackingInput').value.trim();
            if (!input || input.length < 5) {
                showToast('Please enter a valid order ID');
                return;
            }
            
            try {
                let order = null;
                
                // Try Supabase first
                if (supabaseClient) {
                    const { data, error } = await supabaseClient
                        .from('orders')
                        .select('*')
                        .eq('order_id', input)
                        .single();
                    if (!error && data) order = data;
                }
                
                // Fallback to localStorage
                if (!order) {
                    order = JSON.parse(localStorage.getItem('order_' + input) || localStorage.getItem('pending_order_' + input));
                }
                
                if (!order) {
                    showToast('Order not found. Please check your Order ID.');
                    return;
                }
                
                // Display tracking
                document.getElementById('trackingResult').classList.add('active');
                
                // Update timeline dates
                const created = new Date(order.created_at);
                document.getElementById('trackDate1').textContent = created.toLocaleString();
                
                if (order.status !== 'pending') {
                    document.getElementById('trackDate2').textContent = new Date(order.paid_at || order.created_at).toLocaleString();
                }
                
                // Show success
                showToast('Order found! Tracking details loaded.', 'success');
                
                // Scroll to result
                document.getElementById('trackingResult').scrollIntoView({ behavior: 'smooth' });
                
            } catch (error) {
                console.error('Tracking error:', error);
                showToast('Error loading order details');
            }
        }

        async function loadUserOrders() {
            const orders = [];
            
            // Try Supabase
            if (supabaseClient && currentUser) {
                try {
                    const { data, error } = await supabaseClient
                        .from('orders')
                        .select('*')
                        .eq('customer_email', currentUser.email)
                        .order('created_at', { ascending: false });
                    if (!error && data) {
                        renderOrders(data);
                        return;
                    }
                } catch (e) {}
            }
            
            // Fallback to localStorage
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key && (key.startsWith('order_') || key.startsWith('pending_order_'))) {
                    try {
                        orders.push(JSON.parse(localStorage.getItem(key)));
                    } catch(e) {}
                }
            }
            
            if (orders.length > 0) {
                renderOrders(orders.sort((a, b) => new Date(b.created_at) - new Date(a.created_at)));
            } else {
                renderDemoOrders();
            }
        }

        function renderOrders(orders) {
            const container = document.getElementById('ordersList');
            
            if (orders.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: var(--gray); padding: 2rem;">No orders yet. Start shopping!</p>';
                return;
            }
            
            container.innerHTML = orders.map(order => `
                <div class="order-card">
                    <div class="order-header">
                        <div>
                            <div class="order-id">Order #${order.order_id}</div>
                            <div style="color: var(--gray); font-size: 0.875rem;">Placed on ${new Date(order.created_at).toLocaleDateString()}</div>
                        </div>
                        <span class="order-status ${order.status}">${order.status.charAt(0).toUpperCase() + order.status.slice(1)}</span>
                    </div>
                    <div class="order-items">
                        ${order.items.map(item => `
                            <img src="${item.image}" class="order-item-thumb" alt="${item.name}">
                        `).join('')}
                    </div>
                    <div class="order-footer">
                        <div>
                            <div style="font-weight: 700;">Total: ${formatPrice(order.total_amount)}</div>
                            <div style="font-size: 0.875rem; color: var(--gray);">${order.items.length} items</div>
                        </div>
                        <button class="btn btn-outline btn-sm" onclick="document.getElementById('trackingInput').value='${order.order_id}'; showPage('track'); trackOrder();">Track Order</button>
                    </div>
                </div>
            `).join('');
        }

        function renderDemoOrders() {
            const container = document.getElementById('ordersList');
            container.innerHTML = `
                <div style="text-align: center; padding: 3rem; color: var(--gray);">
                    <div style="font-size: 3rem; margin-bottom: 1rem;"></div>
                    <h3>No orders yet</h3>
                    <p style="margin: 1rem 0;">Your order history will appear here</p>
                    <button class="btn btn-primary" onclick="showPage('laptops')">Start Shopping</button>
                </div>
            `;
        }

        async function checkUser() {
            try {
                const { data: { user } } = await supabaseClient.auth.getUser();
                if (user) {
                    currentUser = user;
                    updateUserUI(user);
                }
            } catch (error) {
                console.log('No active session');
            }
        }

        function updateUserUI(user) {
            const email = user.email;
            const name = email.split('@')[0];
            document.getElementById('userEmail').textContent = email;
            document.getElementById('userName').textContent = name.charAt(0).toUpperCase() + name.slice(1);
            document.getElementById('userAvatar').textContent = name.substring(0, 2).toUpperCase();
        }

        async function logout() {
            if (supabaseClient) await supabaseClient.auth.signOut();
            currentUser = null;
            showToast('Logged out successfully');
            setTimeout(() => location.reload(), 1000);
        }

        console.log(' TechVault Pro Enhanced Loaded');
        console.log(' Multi-Currency Support: NGN, USD, GBP, EUR');
        console.log(' Flutterwave Payment: ' + (FLUTTERWAVE_PUBLIC_KEY.includes('FLWPUBK_TEST-b05d360ef5e6b3ae62e09eb7bfc27fe0-X') ? 'NOT CONFIGURED' : (IS_PAYMENT_LIVE ? 'LIVE MODE' : 'TEST MODE')));
        console.log(' Help Chat: Active');
        console.log(' WhatsApp: 07032386595');
        console.log(' Telegram: @fajnigltd');
    </script>
</body>
</html>
